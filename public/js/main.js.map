{"version":3,"sources":["js/main.js"],"names":["jQuery","$","next","openOptions","animations","openOptionsTimeLine__close","pause","css","display","opacity","transform","openOptionsTimeLine","restart","TimelineLite","append","TweenMax","to","addClass","closeOptions","handlerComplete","onComplete","removeClass","on","this","hasClass","e","target","closest","add","size","refreshMenuView","session","data","sessionGroupSynchronizations","length","activeGroups","haveCookie","undefined","cookie","secureEvalJSON","groups","sessionGroupsForNames","key","one","name","filter","item","i","arr","toJSON","removeCookie","activeGroupsObj","html","oneGroup","activeParamsObj","synchroParams","active","empty","groupsSessionToJson","$main","find","each","activeParams","push","attr","sendSessionSortableGroups","onChangeSessionGroups","sendSessionAddGroup","sendSessionDeleteGroup","sendSessionActivatedGroup","activated","onSessionActivatedGroup","sendSessionActivatedParam","nameParam","onSessionActivatedParam","prepend","sortable","axis","items","placeholder","forceHelperSize","forcePlaceholderSize","update","disableSelection","modal","val","trim","alert","text","remove","responseHandlers","createMenuItem","type","localSession","getLocalSessionParams","dragItemList","res","recursion","el","urn","_class","pages","currentPage","collapsed","sub","globalSession","refreshNestedEl","refreshCollapsed","pagesNestedToJson","json","previousLevel","stack","0","level","parents","obj","itemToJson","$item","clearEmptyUl","parent","clearCollapseNotNested","not","pageManagerVisualizator","modules","$mapNavigatorContainer","nameIFrame","pixelsScrollableInSeconds","minWOuterScroll","minHOuterScroll","minWDraggable","minHDraggable","minWIFrame","minHIFrame","responsiveToMovementOfTheCursorInAConfinedSpace","movementOfTheCursorInAConfinedSpaceSpred","gorizontalFixation","verticalFixation","mCustomScrollbar","theme","scrollbarPosition","scrollInertia","mouseWheel","scrollAmount","toggleClass","handlerSelectPage","changePage","page","selectPage","event","getPage","_options","window","location","href","get","focus","getGroup","$cutItems","after","newName","nestedSortable","handle","revert","tabSize","toleranceElement","listType","helper","maxLevels","isTree","start","stop","ui","savePages","$container","pmv.prepaste.iframe","width","height","pmv.load.iframe","setTimeout","_create","setParamDeviation","pos","l","t","lpx","lper","tpx","tper","$static","first","$fixed","last","prop","$relative","deviationInput","refreshSpinner","spinner","min","max","spin","step","createScreenshotsList","resolution","screenshotsRelated","w","h","screenshotsObjList","getScreenshotsObjList","screenshots","s","globalScreenshotsRelatedData","refreshSortableScreensotsInResolutions","cursor","distance","connectWith","refreshMenuAllScreenshots__specific","refreshButtonsPageProofsOrDesign","show","pixelPerfect","dirScrins","_destroy","screenshotsCollection","getCurrentRelatedScreenshotsCollection","refreshScrins","callbacks","onUpdate","hasError","test","parseInt","resolutions","$li","$size","stopPropagation","_","currentResolution","designScreenshotsRelatedResolutionAndPage","collapsedToObj","designScreenshotsFoldersUncollapsed","designScreenshots","windowThumbnail__timeoutId","mouseenter","clearTimeout","mouseleave","$optionSelected","selectSize","showPageProofsOrDesign","contents","which","ctrlKey","shiftKey","altKey","cancelBubble","preventDefault","document","ready","tooltip","popover","socket","io","connect","once","sessionModel"],"mappings":"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","file":"main.js","sourcesContent":["/****************************************************/\r\n/*Шаблонизатор*/\r\n/****************************************************/\r\njQuery(function($) {\r\n    $(\"body\").on('keydown', function(e) {\r\n        if(e.which == 49 && e.altKey)//(e.which == 65 || e.which == 83 || e.which == 68)\r\n        {\r\n            e = e || window.e; if (e.stopPropagation) {e.stopPropagation()} else {e.cancelBubble = true} e.preventDefault();\r\n        }\r\n    });\r\n\r\n    var session;\r\n    var socket = io.connect('/');\r\n\r\n    socket.once('session.load', function (data) {\r\n        session = new modules.sessionModel(data, socket);\r\n        //console.log(data);\r\n        next();\r\n    });\r\n\r\n    function next() {\r\n        //Глобальные настройки\r\n        (function() {\r\n            var animations = {};\r\n            $( \".shab__global-settings-btn\" ).on(\"click\", function () {\r\n                if( !$(this).hasClass('active') ) {\r\n                    openOptions();\r\n                } else {\r\n                    closeOptions();\r\n                }\r\n            });\r\n\r\n            $( \"body\" ).on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".shab__global-settings-btn\").add($(\".shab__global-settings\"))).size() == 0 ) {\r\n                    if( $(\".shab__global-settings-btn\").hasClass('active') ) {\r\n                        closeOptions();\r\n                    }\r\n                }\r\n            });\r\n\r\n            function openOptions() {\r\n                if( \"openOptionsTimeLine__close\" in animations ) { animations.openOptionsTimeLine__close.pause() }\r\n                $(\" .shab__global-settings\").css({\r\n                    display: \"block\",\r\n                    opacity: 0,\r\n                    transform: \"scale(0.8, 0.8)\"\r\n                });\r\n\r\n                if( !(\"openOptionsTimeLine\" in animations) ) {\r\n                    animations.openOptionsTimeLine = (new TimelineLite()).append([\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{transform: \"scale(1, 1)\" }}),\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.3,\r\n                            {css:{ opacity: 1 }})\r\n                    ]);\r\n                } else {\r\n                    animations.openOptionsTimeLine.restart();\r\n                }\r\n\r\n                $( \".shab__global-settings-btn\" ).addClass('active');\r\n            }\r\n\r\n            function closeOptions() {\r\n                if( \"openOptionsTimeLine\" in animations ) { animations.openOptionsTimeLine.pause() }\r\n                if( !(\"openOptionsTimeLine__close\" in animations) ) {\r\n                    animations.openOptionsTimeLine__close = (new TimelineLite()).append([\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{ transform: \"scale(0.8, 0.8)\"}, onComplete: handlerComplete}),\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{ opacity: 0 }})\r\n                    ]);\r\n                } else {\r\n                    animations.openOptionsTimeLine__close.restart();\r\n                }\r\n                function handlerComplete() {\r\n                    $(\".shab__global-settings\").css('display', 'none');\r\n                }\r\n\r\n                $( \".shab__global-settings-btn\" ).removeClass('active');\r\n            }\r\n\r\n            //$('#text-encoding-server').selectpicker();\r\n\r\n            //Кодировка на хосте\r\n            //$('#text-encoding-server').selectpicker('val', shablonizator.settings.find('text_encoding_server').text());\r\n\r\n            /*$('#text-encoding-server').on('change', function(){\r\n                shablonizator.textEncodingServer = $(this).val();\r\n                shablonizator.settings.find('text_encoding_server').text($(this).val());\r\n                shablonizator.save_g_settings();\r\n            });*/\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Синхронизация по группам сессий*/\r\n        /****************************************************/\r\n        (function() {\r\n            //Свернуть-развернуть список выбора групп\r\n            $(\".shab__btn-open-groups-session\").on(\"click\", function () {\r\n                if(!$(this).hasClass('active')) {\r\n                    $(this).addClass('active');\r\n                    $(\".shab__session-groups-list\").addClass('open');\r\n                } else {\r\n                    $(this).removeClass('active');\r\n                    $(\".shab__session-groups-list\").removeClass('open');\r\n                }\r\n            });\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".shab__btn-open-groups-session\").add($(\".shab__session-groups-list\")).add($(\"#shab-add-group-session\")).add($(\"#shab-delete-group-session\"))).length == 0 ) {\r\n                    $(\".shab__btn-open-groups-session\").removeClass('active');\r\n                    $(\".shab__session-groups-list\").removeClass('open');\r\n                }\r\n            });\r\n\r\n            //Формирование меню групп сессий\r\n            $(\".shab__session-groups-list\").prepend(\"<ul class='shab__session-groups-list-ul'></ul>\");\r\n            refreshMenuView();\r\n            $(\".shab__session-groups-list-ul\").sortable({\r\n                    axis: \"y\",\r\n                    //handle: 'button',\r\n                    items: \"> li\",\r\n                    placeholder: \"placeholder\",\r\n                    forceHelperSize: true,\r\n                    forcePlaceholderSize: true,\r\n                    update: function() {\r\n                        sendSessionSortableGroups();\r\n                    }\r\n                })\r\n                .disableSelection();\r\n            function refreshMenuView() {\r\n                if(session.data.sessionGroupSynchronizations.length) {\r\n                    var haveCookie = $.cookie('adaptive_pixel_perfect_groups_session') !== undefined;\r\n                    var activeGroups;\r\n\r\n                    if(haveCookie) {\r\n                        activeGroups = $.secureEvalJSON($.cookie('adaptive_pixel_perfect_groups_session')).groups;\r\n                        //список в обьект по именам групп сессий\r\n                        var sessionGroupsForNames = {};\r\n                        for(var key in session.data.sessionGroupSynchronizations) {\r\n                            var one = session.data.sessionGroupSynchronizations[key];\r\n                            sessionGroupsForNames[one.name] = one;\r\n                        }\r\n\r\n                        //Удаляем имена выбранных групп которых уже нету\r\n                        activeGroups.filter(function(item, i, arr) {\r\n                            return item in sessionGroupsForNames;\r\n                        });\r\n                        $.cookie('adaptive_pixel_perfect_groups_session', $.toJSON({\"groups\": activeGroups}));\r\n                        if(!activeGroups.length) {\r\n                            $.removeCookie('adaptive_pixel_perfect_groups_session');\r\n                            haveCookie = false;\r\n                            activeGroups = [];\r\n                        }\r\n                    }\r\n                    var activeGroupsObj = {};\r\n                    for(var i in activeGroups) {\r\n                        activeGroupsObj[activeGroups[i]] = true;\r\n                    }\r\n\r\n                    //Формируем меню\r\n                    var html = \"\";\r\n\r\n                    for(var key in session.data.sessionGroupSynchronizations) {\r\n                        var oneGroup = session.data.sessionGroupSynchronizations[key];\r\n\r\n                        var activeParamsObj = {};\r\n                        for(var i in oneGroup.synchroParams) {\r\n                            activeParamsObj[oneGroup.synchroParams[i]] = true;\r\n                        }\r\n\r\n                        var active = (haveCookie && (oneGroup.name in activeGroupsObj))?\"active\":\"\";\r\n                        html += '<li class=\"shab__session-groups-list-item '+active+'\" data-name=\"'+(oneGroup.name)+'\">' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"pages\"       in activeParamsObj)?\"active\":\"\")+'\" data-param=\"pages\"><i class=\"fa fa-file-o\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"resolutions\" in activeParamsObj)?\"active\":\"\")+'\" data-param=\"resolutions\"><i class=\"fa fa-arrows\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"iframe\"      in activeParamsObj)?\"active\":\"\")+'\" data-param=\"iframe\"><i class=\"fa fa-desktop\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs btn-block shab__session-groups-list-btn '+active+'\">'+(oneGroup.name)+'</button>' +\r\n                            '<div class=\"btn btn-default btn-xs shab__session-groups-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                            '</li>';\r\n                    }\r\n\r\n                    $(\".shab__session-groups-list-ul\").empty().append(html);\r\n                } else {\r\n                    if($.cookie('adaptive_pixel_perfect_groups_session') !== undefined) {\r\n                        $.removeCookie('adaptive_pixel_perfect_groups_session');\r\n                    }\r\n                }\r\n            }\r\n\r\n            //Добавить группу\r\n            $('.shab__add-group-session').on('click', function(){\r\n                $('#shab-add-group-session .modal').modal('show');\r\n            });\r\n            $('#shab-add-group-session .btn-select').on('click', function(){\r\n                var name = $('#shab-add-group-session .shab-add-group-session__name').val();\r\n                if($.trim(name)) {\r\n                    var html = '<li class=\"shab__session-groups-list-item\" data-name=\"'+($.trim(name))+'\">' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"pages\"><i class=\"fa fa-file-o\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"resolutions\"><i class=\"fa fa-arrows\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"iframe\"><i class=\"fa fa-desktop\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs btn-block shab__session-groups-list-btn\">'+($.trim(name))+'</button>' +\r\n                        '<div class=\"btn btn-default btn-xs shab__session-groups-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                        '</li>';\r\n                    $(\".shab__session-groups-list-ul\").append(html);\r\n\r\n                    sendSessionAddGroup();\r\n                } else {\r\n                    alert(\"Имя недолжно быть пустым\");\r\n                }\r\n                $('#shab-add-group-session .modal').modal('hide');\r\n            });\r\n\r\n            //Удалить группу\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-delete-btn\", function(){\r\n                $('#shab-delete-group-session .modal').modal('show');\r\n\r\n                var name = $(this).closest(\".shab__session-groups-list-item\").attr(\"data-name\");\r\n                $('#shab-delete-group-session .shab-delete-group-session__name')\r\n                    .attr(\"data-name\", name)\r\n                    .text(name);\r\n            });\r\n            $('#shab-delete-group-session .btn-select').on('click', function(){\r\n                var name = $('#shab-delete-group-session .shab-delete-group-session__name').attr(\"data-name\");\r\n                $(\".shab__session-groups-list-item[data-name='\"+name+\"']\").remove();\r\n\r\n                sendSessionDeleteGroup();\r\n\r\n                $('#shab-delete-group-session .modal').modal('hide');\r\n            });\r\n\r\n            //Активировать-деактивировать группу\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-list-btn\", function(){\r\n                if($(\".shab__session-groups-list.open\").length) {\r\n                    if(!$(this).hasClass(\"active\")) {\r\n                        $(this).addClass(\"active\")\r\n                            .closest(\".shab__session-groups-list-item\").addClass(\"active\");\r\n                    } else {\r\n                        $(this).removeClass(\"active\")\r\n                            .closest(\".shab__session-groups-list-item\").removeClass(\"active\");\r\n                    }\r\n\r\n                    sendSessionActivatedGroup($(this).closest(\".shab__session-groups-list-item\").attr(\"data-name\"), $(this).hasClass(\"active\"));\r\n                }\r\n            });\r\n\r\n            //Активировать-деактивировать параметр группы\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-synchro-params-btn\", function(){\r\n                if(!$(this).hasClass(\"active\")) {\r\n                    $(this).addClass(\"active\");\r\n                } else {\r\n                    $(this).removeClass(\"active\");\r\n                }\r\n\r\n                sendSessionActivatedParam($(this).closest(\".shab__session-groups-list-item\").attr(\"data-name\"), $(this).attr(\"data-param\"), $(this).hasClass(\"active\"));\r\n            });\r\n\r\n            function groupsSessionToJson($main) {\r\n                var sessionGroupSynchronizations = [];\r\n                $main.find(\" .shab__session-groups-list-ul > li\").each(function() {\r\n                    var activeParams = [];\r\n                    $(this).find(\" .shab__session-groups-synchro-params-btn.active\").each(function() {\r\n                        activeParams.push($(this).attr(\"data-param\"));\r\n                    });\r\n                    sessionGroupSynchronizations.push({\r\n                        name: $(this).attr(\"data-name\"),\r\n                        synchroParams: activeParams\r\n                    });\r\n                });\r\n                return sessionGroupSynchronizations;\r\n            }\r\n\r\n            //Запись и отправка данных сессии\r\n            function sendSessionSortableGroups() {\r\n                session.onChangeSessionGroups(groupsSessionToJson($('.shab__session-groups-list')));\r\n            }\r\n            function sendSessionAddGroup() {\r\n                session.onChangeSessionGroups(groupsSessionToJson($('.shab__session-groups-list')));\r\n            }\r\n            function sendSessionDeleteGroup() {\r\n                session.onChangeSessionGroups(groupsSessionToJson($('.shab__session-groups-list')));\r\n            }\r\n            function sendSessionActivatedGroup(name, activated) {\r\n                session.onSessionActivatedGroup(name, activated);\r\n            }\r\n            function sendSessionActivatedParam(name, nameParam, activated) {\r\n                session.onSessionActivatedParam(name, nameParam, activated);\r\n            }\r\n\r\n            //Приём данных сессии\r\n            session.responseHandlers[\"onChangeSessionGroups\"] = function() {\r\n                refreshMenuView();\r\n            }\r\n            session.responseHandlers[\"onSessionActivatedParam\"] = function() {\r\n                refreshMenuView();\r\n            }\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Менеджер страниц и визуализатор*/\r\n        /****************************************************/\r\n        (function() {\r\n            pageManagerVisualizator = new modules.pageManagerVisualizator($(\"#wrap_iframe\"), session, {\r\n                $mapNavigatorContainer: $('.mnif__navigator-window'),\r\n                nameIFrame: \"PP_iframe\",\r\n                pixelsScrollableInSeconds: 2000,\r\n                minWOuterScroll: 23,\r\n                minHOuterScroll: 23,\r\n                minWDraggable: 15,\r\n                minHDraggable: 15,\r\n                minWIFrame: 320,\r\n                minHIFrame: 480,\r\n                responsiveToMovementOfTheCursorInAConfinedSpace: true,\r\n                movementOfTheCursorInAConfinedSpaceSpred: 10,\r\n                gorizontalFixation: \"center\",\r\n                verticalFixation: \"top\"\r\n            });\r\n\r\n            //Скроллбар для списка страниц\r\n            $(\".pmv__pages-sortable-scrollwrap\").mCustomScrollbar({\r\n                axis: \"y\",\r\n                theme: \"dark\",\r\n                scrollbarPosition: \"outside\",\r\n                scrollInertia: 100,\r\n                mouseWheel: {\r\n                    scrollAmount: 100\r\n                }\r\n            });\r\n\r\n            //Открыть-закрыть меню выбора страниц\r\n            $(\".pmv__select-page-open-list\").on(\"click\", function () {\r\n                $(this).toggleClass('active');\r\n            });\r\n            var dragItemList = false;\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".pmv__select-page-open-list\").add($(\".pmv__pages-window, #modal-pmv-add-page-href, #pmv__modal-add-group, #shab__page-or-group-delete, #shab__page-or-group-update\"))).length == 0 && !dragItemList ) {\r\n                    $(\".pmv__select-page-open-list\").removeClass('active');\r\n                }\r\n            });\r\n\r\n            //Сменяем страницу\r\n            $('.pmv__pages-sortable').on('click', ' .pmv__pages-btn-page', function() {\r\n                $(\".pmv__pages-btn-page\").removeClass(\"active\");\r\n                $(this).addClass(\"active\");\r\n                pageManagerVisualizator.handlerSelectPage( $(this).closest(\".pmv__pages-item\").attr(\"data-name\") );\r\n                if( $(\".pmv__select-page-open-list\").hasClass('active') ) {\r\n                    $(\".pmv__select-page-open-list\").removeClass('active');\r\n                }\r\n            });\r\n            $(\"body\").on(\"pmv.user.changepage\", function(){\r\n                session.changePage(pageManagerVisualizator.currentPage);\r\n            });\r\n            $(\"body\").on(\"synchro.changed_page\", function(e, page){\r\n                $(\".pmv__pages-btn-page\").removeClass(\"active\");\r\n                $(\".pmv__pages-item[data-name='\"+page+\"'] > * > .pmv__pages-btn-page\").addClass(\"active\");\r\n                session.selectPage(page);\r\n            });\r\n\r\n            //Добавляем страницу\r\n            $('#modal-pmv-add-page-href .btn-select').on('click', function(event){\r\n                var urn = $('#modal-pmv-add-page-href .pmv-href').val();\r\n\r\n                //Проверяем на ошибки\r\n                $('.pmv__modal-urn-exists').css({display: \"\"});\r\n                $('.pmv__modal-urn-empty').css({display: \"\"});\r\n                $('.pmv__modal-add-page-content').removeClass(\"has-error\");\r\n\r\n                if($.trim(urn)) {\r\n                    if(session.getPage(urn) === false) {\r\n                        next();\r\n                    } else {\r\n                        $('.pmv__modal-urn-exists').css({display: \"block\"});\r\n                        $('.pmv__modal-add-page-content').addClass(\"has-error\");\r\n                    }\r\n                } else {\r\n                    $('.pmv__modal-urn-empty').css({display: \"block\"});\r\n                    $('.pmv__modal-add-page-content').addClass(\"has-error\");\r\n                }\r\n\r\n                //Добавляем страницу\r\n                function next() {\r\n                    $(\".pmv__pages-sortable > ul\").prepend( createMenuItem(\"page\", $.trim(urn)) );\r\n                    $('#modal-pmv-add-page-href .modal').modal('hide');\r\n                }\r\n            });\r\n            $('.pmv__add-page').on('click', function(){\r\n                $('.pmv__modal-urn-exists').css({display: \"\"});\r\n                $('.pmv__modal-urn-empty').css({display: \"\"});\r\n                $('.pmv__modal-add-page-content').removeClass(\"has-error\");\r\n\r\n                if(pageManagerVisualizator._options.nameIFrame in window) {\r\n                    //отделить домен от urn\r\n                    $('#modal-pmv-add-page-href .pmv-href').val( window[pageManagerVisualizator._options.nameIFrame].window.location.href );\r\n                }\r\n                $('#modal-pmv-add-page-href .modal').modal('show');\r\n            });\r\n            $('#modal-pmv-add-page-href').on('shown.bs.modal', function(e){\r\n                var input = $('#modal-pmv-add-page-href .pmv-href');\r\n                //Выделение\r\n                input.get(0).focus();\r\n                //input.get(0).setSelectionRange(0, input.val().length);\r\n            });\r\n\r\n            //Добавляем группу\r\n            $('#pmv__modal-add-group .btn-select').on('click', function(event){\r\n                var name = $('#pmv__modal-add-group .pmv__modal-name-group').val();\r\n\r\n                //Проверяем на ошибки\r\n                $('#pmv__modal-add-group .pmv__modal-name-exists').css({display: \"\"});\r\n                $('#pmv__modal-add-group .pmv__modal-name-empty').css({display: \"\"});\r\n                $('.pmv__modal-add-group-content').removeClass(\"has-error\");\r\n                if($.trim(name)) {\r\n                    if(session.getGroup(name) === false) {\r\n                        next();\r\n                    } else {\r\n                        $('.pmv__modal-name-exists').css({display: \"block\"});\r\n                        $('.pmv__modal-add-group-content').addClass(\"has-error\");\r\n                    }\r\n                } else {\r\n                    $('#pmv__modal-add-group .pmv__modal-name-empty').css({display: \"block\"});\r\n                    $('.pmv__modal-add-group-content').addClass(\"has-error\");\r\n                }\r\n\r\n                //Добавляем группу\r\n                function next() {\r\n                    $(\".pmv__pages-sortable > ul\").prepend( createMenuItem(\"group\", $.trim(name)) );\r\n                    $('#pmv__modal-add-group .modal').modal('hide');\r\n                }\r\n            });\r\n            $('.pmv__add-group').on('click', function(){\r\n                $('#pmv__modal-add-group .pmv__modal-name-exists').css({display: \"\"});\r\n                $('#pmv__modal-add-group .pmv__modal-name-empty').css({display: \"\"});\r\n                $('.pmv__modal-add-group-content').removeClass(\"has-error\");\r\n\r\n                $('#pmv__modal-add-group .modal').modal('show');\r\n            });\r\n\r\n            //Удаляем страницу или группу\r\n            $('.pmv__pages-sortable').on('click', \" .pmv__pages-btn-delete\", function(){\r\n                if($(this).closest(\".pmv__pages-item\").hasClass(\"have-nested\")) {\r\n                    $(\"#shab__page-or-group-delete .shab__page-or-group-delete-nested-btn\").css({display: \"inline-block\"});\r\n                } else {\r\n                    $(\"#shab__page-or-group-delete .shab__page-or-group-delete-nested-btn\").css({display: \"none\"});\r\n                }\r\n\r\n                $('#shab__page-or-group-delete .modal').modal('show');\r\n\r\n                var name = $(this).closest(\".pmv__pages-item\").attr(\"data-name\");\r\n                var type = $(this).closest(\".pmv__pages-item\").attr(\"data-type\");\r\n                $('#shab__page-or-group-delete .shab__page-or-group__name')\r\n                    .attr(\"data-name\", name)\r\n                    .text(name);\r\n                $('#shab__page-or-group-delete .shab__page-or-group__type').text((type == \"page\")?\"страницу\":\"группу\");\r\n            });\r\n            $('#shab__page-or-group-delete .shab__page-or-group-delete-btn').on('click', function(){\r\n                var name = $('#shab__page-or-group-delete .shab__page-or-group__name').attr(\"data-name\");\r\n                var $cutItems = $(\".pmv__pages-item[data-name='\"+name+\"'] > ul > .pmv__pages-item\").remove();\r\n                $(\".pmv__pages-item[data-name='\"+name+\"']\").after($cutItems);\r\n                $(\".pmv__pages-item[data-name='\"+name+\"']\").remove();\r\n\r\n                var $main = $(\".pmv__pages-sortable\");\r\n                clearEmptyUl($main);\r\n                refreshNestedEl($main);\r\n                clearCollapseNotNested($main);\r\n\r\n                $('#shab__page-or-group-delete .modal').modal('hide');\r\n            });\r\n            $('#shab__page-or-group-delete .shab__page-or-group-delete-nested-btn').on('click', function(){\r\n                var name = $('#shab__page-or-group-delete .shab__page-or-group__name').attr(\"data-name\");\r\n                $(\".pmv__pages-item[data-name='\"+name+\"']\").remove();\r\n\r\n                var $main = $(\".pmv__pages-sortable\");\r\n                clearEmptyUl($main);\r\n                refreshNestedEl($main);\r\n                clearCollapseNotNested($main);\r\n\r\n                $('#shab__page-or-group-delete .modal').modal('hide');\r\n            });\r\n\r\n            //Обновляем страницу или группу\r\n            $('.pmv__pages-sortable').on('click', \" .pmv__pages-btn-edit\", function(){\r\n                $('#shab__page-or-group-update .modal').modal('show');\r\n\r\n                var name = $(this).closest(\".pmv__pages-item\").attr(\"data-name\");\r\n                var type = $(this).closest(\".pmv__pages-item\").attr(\"data-type\");\r\n                $('#shab__page-or-group-update .shab__page-or-group__name')\r\n                    .attr(\"data-name\", name);\r\n                $('#shab__page-or-group-update .shab__page-or-group-update__name').val(name);\r\n\r\n                $('#shab__page-or-group-update .shab__page-or-group__type').attr(\"data-type\", type).text((type == \"page\")?\"новый URN\":\"новое имя\");\r\n            });\r\n            $('#shab__page-or-group-update .btn-select').on('click', function(){\r\n                var name = $('#shab__page-or-group-update .shab__page-or-group__name').attr(\"data-name\");\r\n                var type = $('#shab__page-or-group-update .shab__page-or-group__type').attr(\"data-type\");\r\n                var newName = $('#shab__page-or-group-update .shab__page-or-group-update__name').val();\r\n\r\n                //Проверяем на ошибки\r\n                $('#shab__page-or-group-update .pmv__modal-urn-exists').css({display: \"\"});\r\n                $('#shab__page-or-group-update .pmv__modal-name-exists').css({display: \"\"});\r\n                $('#shab__page-or-group-update .pmv__modal-empty').css({display: \"\"});\r\n                $('#shab__page-or-group-update .pmv__modal-content').removeClass(\"has-error\");\r\n\r\n                if(type == \"page\") {\r\n                    if($.trim(newName)) {\r\n                        if(session.getPage(newName) === false) {\r\n                            next();\r\n                        } else {\r\n                            $('#shab__page-or-group-update .pmv__modal-urn-exists').css({display: \"block\"});\r\n                            $('#shab__page-or-group-update .pmv__modal-content').addClass(\"has-error\");\r\n                        }\r\n                    } else {\r\n                        $('#shab__page-or-group-update .pmv__modal-empty').css({display: \"block\"});\r\n                        $('#shab__page-or-group-update .pmv__modal-content').addClass(\"has-error\");\r\n                    }\r\n                } else {\r\n                    if($.trim(newName)) {\r\n                        if(session.getGroup(newName) === false) {\r\n                            next();\r\n                        } else {\r\n                            $('#shab__page-or-group-update .pmv__modal-name-exists').css({display: \"block\"});\r\n                            $('#shab__page-or-group-update .pmv__modal-content').addClass(\"has-error\");\r\n                        }\r\n                    } else {\r\n                        $('#shab__page-or-group-update .pmv__modal-empty').css({display: \"block\"});\r\n                        $('#shab__page-or-group-update .pmv__modal-content').addClass(\"has-error\");\r\n                    }\r\n                }\r\n\r\n                //Добавляем страницу\r\n                function next() {\r\n                    $(\".pmv__pages-sortable .pmv__pages-item[data-type='\"+type+\"'][data-name='\"+name+\"']\")\r\n                        .attr(\"data-name\", newName)\r\n                        .find(\" > * > .pmv__pages-btn-name\").text(newName);\r\n\r\n                    $('#shab__page-or-group-update .modal').modal('hide');\r\n                }\r\n            });\r\n\r\n            //Генерируем пункт меню\r\n            function createMenuItem(type, name) {\r\n                var _class = (type == \"page\")?\"page\":\"group btn-yellow\";\r\n                return '<li class=\"pmv__pages-item\" data-type=\"'+type+'\" data-name=\"'+name+'\">' +\r\n                    '<div class=\"pmv__pages-item-content\">' +\r\n                    '<button class=\"btn btn-default btn-xs pmv__pages-btn-collapsed\"><span class=\"glyphicon glyphicon-minus\"></span><span class=\"glyphicon glyphicon-plus\"></span></button>' +\r\n                    '<button class=\"btn btn-default btn-xs btn-block pmv__pages-btn-name pmv__pages-btn-'+_class+'\">'+name+'</button>' +\r\n                    '<button class=\"btn btn-default btn-xs pmv__pages-btn-delete\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                    '<button class=\"btn btn-default btn-xs pmv__pages-btn-edit\"><span class=\"glyphicon glyphicon-edit\"></span></button>' +\r\n                    '<div class=\"btn btn-default btn-xs pmv__pages-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                    '</div>' +\r\n                    '</li>';\r\n\r\n            }\r\n\r\n            //Обновляем список страниц в верхнем меню\r\n            $(\".pmv__pages-sortable\").prepend(\"<ul class='pmv__pages-sortable-ul'></ul>\");\r\n            $(\".pmv__pages-sortable-ul\").nestedSortable({\r\n                forcePlaceholderSize: true,\r\n                handle: 'div',\r\n                items: 'li',\r\n                placeholder: 'placeholder',\r\n                revert: 250,\r\n                tabSize: 25,\r\n                toleranceElement: '> div',\r\n                listType: \"ul\",\r\n                helper:\t'clone',\r\n                maxLevels: 3,\r\n                isTree: true,\r\n                start: function () {\r\n                    dragItemList = true;\r\n                },\r\n                stop: function () {\r\n                    dragItemList = false;\r\n                },\r\n                update: function( event, ui ) {\r\n                    var $main = $(\".pmv__pages-sortable\");\r\n                    clearEmptyUl($main);\r\n                    refreshNestedEl($main);\r\n                    clearCollapseNotNested($main);\r\n                    session.data.pages = pagesNestedToJson($main);\r\n                    session.savePages();\r\n                }\r\n            });\r\n\r\n            pageManagerVisualizator.$container.on(\"pmv.change.pagelist\", refreshMenuView);\r\n            refreshMenuView();\r\n            \r\n            function refreshMenuView() {\r\n                var localSession = session.getLocalSessionParams();\r\n                dragItemList = false;\r\n                var $main = $(\".pmv__pages-sortable-ul\");\r\n                $main.empty();\r\n\r\n                var res = (function recursion(el, html) {\r\n                    //li\r\n                    for(var i in el) {\r\n                        var name = (el[i].type == \"page\") ? el[i].urn : el[i].name;\r\n                        var _class = (el[i].type == \"page\")?\"page\":\"group btn-yellow\";\r\n                        var active = (el[i].type == \"page\" && localSession && \"pages\" in localSession && localSession.pages.currentPage === name)?\"active\":\"\";\r\n                        html += \"<li class='pmv__pages-item \"+((\"collapsed\" in el[i] && el[i].collapsed)?\"collapsed\":\"\")+\"' data-type='\"+(el[i].type)+\"' data-name='\"+name+\"'>\";\r\n                        html += '<div class=\"pmv__pages-item-content\">' +\r\n                            '<button class=\"btn btn-default btn-xs pmv__pages-btn-collapsed\"><span class=\"glyphicon glyphicon-minus\"></span><span class=\"glyphicon glyphicon-plus\"></span></button>' +\r\n                            '<button class=\"btn btn-default btn-xs btn-block pmv__pages-btn-name pmv__pages-btn-'+_class+' '+active+'\">'+name+'</button>' +\r\n                            '<button class=\"btn btn-default btn-xs pmv__pages-btn-delete\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                            '<button class=\"btn btn-default btn-xs pmv__pages-btn-edit\"><span class=\"glyphicon glyphicon-edit\"></span></button>' +\r\n                            '<div class=\"btn btn-default btn-xs pmv__pages-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                            '</div>';\r\n\r\n                        //sub\r\n                        if(\"sub\" in el[i]) {\r\n                            html = recursion(el[i].sub, html+\"<ul>\")+\"</ul>\";\r\n                        }\r\n                        //sub (end)\r\n\r\n                        html += \"</li>\";\r\n\r\n                    }\r\n                    //li (end)\r\n\r\n                    return html;\r\n                })(session.data.globalSession.pages, \"\");\r\n\r\n                $main.append(res);\r\n                refreshNestedEl($(\".pmv__pages-sortable\"));\r\n                refreshCollapsed($(\".pmv__pages-sortable\"));\r\n            }\r\n\r\n            $(\".pmv__pages-sortable\").on(\"click\", \" .pmv__pages-btn-collapsed\", function(){\r\n                var $item = $(this).closest(\".pmv__pages-item\");\r\n                if( $item.hasClass(\"collapsed\") ) {\r\n                    $item.removeClass(\"collapsed\")\r\n                        .find(\" > ul\").css({display: \"block\"});\r\n                } else {\r\n                    $item.addClass(\"collapsed\")\r\n                        .find(\" > ul\").css({display: \"none\"});\r\n                }\r\n            });\r\n\r\n            //Парсинг страниц в json обьект\r\n            function pagesNestedToJson($main) {\r\n                var json = [], previousLevel = 0, stack = {\"0\":json};\r\n\r\n                $main.find(\".pmv__pages-item\").each(function() {\r\n                    var level = $(this).parents(\".pmv__pages-item\").length;\r\n                    if(level > previousLevel) {\r\n                        var obj = stack[previousLevel][stack[previousLevel].length-1];\r\n                        if(!(\"sub\" in obj)) {\r\n                            obj.sub = [];\r\n                            stack[level] = obj.sub;\r\n                        }\r\n                        stack[level].push(itemToJson($(this)));\r\n                    } else {\r\n                        stack[level].push(itemToJson($(this)));\r\n                    }\r\n                    previousLevel = level;\r\n                });\r\n\r\n                return json;\r\n            }\r\n\r\n                function itemToJson($item) {\r\n                    var obj = {};\r\n                    obj.type = $item.attr(\"data-type\");\r\n\r\n                    if($item.attr(\"data-type\") == \"page\") {\r\n                        obj.urn = $item.attr(\"data-name\");\r\n                    } else {\r\n                        obj.name = $item.attr(\"data-name\");\r\n                    }\r\n\r\n                    if($item.hasClass(\"collapsed\")) {\r\n                        obj.collapsed = true;\r\n                    }\r\n                    return obj;\r\n                }\r\n\r\n            //удаляем пустые тэги ul которые остаються после перестановки\r\n            function clearEmptyUl($main) {\r\n                $main.find(\" ul\").addClass(\"not-childrens\");\r\n                $main.find(\" ul > li\").each(function() {\r\n                    $(this).parent().removeClass(\"not-childrens\");\r\n                });\r\n                $main.find(\" ul.not-childrens\").remove();\r\n            }\r\n\r\n            //очитстить от коллапсов\r\n            function clearCollapseNotNested($main) {\r\n                $main.find(\" .pmv__pages-item\").each(function() {\r\n                    if(!$(this).hasClass(\"have-nested\")) {\r\n                        $(this).removeClass(\"collapsed\");\r\n                    }\r\n                });\r\n            }\r\n            function refreshNestedEl($main) {\r\n                //Вставляем класс для вложенных\r\n                $main.find(\" .pmv__pages-item\").removeClass(\"have-nested\");\r\n                $main.find(\" ul\").each(function() {\r\n                    if($(this).parent(\".pmv__pages-item\").length) {\r\n                        $(this).parent(\".pmv__pages-item\").addClass(\"have-nested\");\r\n                    }\r\n                });\r\n            }\r\n            function refreshCollapsed($main) {\r\n                //Коллапсируем рассколапсируем\r\n                $main.find(\" .pmv__pages-item.collapsed > ul\").css({display: \"none\"});\r\n                $main.find(\" .pmv__pages-item > ul\").not($main.find(\" .pmv__pages-item.collapsed > ul\")).css({display: \"block\"});\r\n            }\r\n\r\n            //При загрузке iFrame скрываем всё окно шаблонизатора и показываем анимацию загрузки\r\n            pageManagerVisualizator.$container.on({\r\n                \"pmv.prepaste.iframe\": function() {\r\n                    $( \"#loading\" )\r\n                        .css({width: \"100%\", height: \"100%\"})\r\n                        .addClass( \"show\" );\r\n                },\r\n                \"pmv.load.iframe\": function() {\r\n                    $( \"#loading\" ).removeClass( \"show\" );\r\n                    setTimeout(function() {\r\n                        $( \"#loading\" ).css({width: \"0\", height: \"0\"});\r\n                    }, 500);\r\n                }\r\n            });\r\n\r\n            pageManagerVisualizator._create();\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Пиксель перфект*/\r\n        /****************************************************/\r\n        (function() {\r\n            pixelPerfect = new modules.pixelPerfect($(\"#wrap_iframe .pmv-fitting-wrap\"), {\r\n                dirScrins: \"design-screenshots\",\r\n                nameIFrame: \"PP_iframe\"\r\n            });\r\n\r\n            pageManagerVisualizator.$container.on( \"pmv.load.iframe\", function(){\r\n                pixelPerfect._destroy();\r\n                pixelPerfect._create();\r\n\r\n                var screenshotsCollection = session.getCurrentRelatedScreenshotsCollection();\r\n                if(screenshotsCollection !== null) {\r\n                    pixelPerfect.refreshScrins(screenshotsCollection, session.getScreenshotsObjList());\r\n                }\r\n            });\r\n\r\n            //Скроллбар для списка скриншотов привязанных к разрешениям и страницам\r\n            $(\".pp__screenshots-menu-scrollwrap, .pp__screenshots-files-menu-scrollwrap, .pp__screenshot-thumbnail-scrollwrap\").mCustomScrollbar({\r\n                axis: \"y\",\r\n                theme: \"dark\",\r\n                scrollbarPosition: \"outside\",\r\n                scrollInertia: 100,\r\n                mouseWheel: {\r\n                    scrollAmount: 100\r\n                },\r\n                callbacks: {\r\n                    onUpdate: function() {\r\n                        /*if($(\".pmv__pages-sortable-scrollwrap\").hasClass(\"_mCS_1 mCS_no_scrollbar\")) {\r\n                            $(\".pmv__pages-window\").addClass(\"no-scrollbar\");\r\n                        } else {\r\n                            $(\".pmv__pages-window\").removeClass(\"no-scrollbar\");\r\n                        }*/\r\n                    }\r\n                }\r\n            });\r\n\r\n            //Свернуть-развернуть список скриншотов привязанных к разрешениям и страницам\r\n            $(\".pp__btn-open-screenshots\").on(\"click\", function () {\r\n                if(!$(this).hasClass('active')) {\r\n                    $(this).addClass('active');\r\n                    $(\".pp__screenshots-menu-window, .pp__screenshots-files-menu-scrollwrap\").addClass('open');\r\n                } else {\r\n                    $(this).removeClass('active');\r\n                    $(\".pp__screenshots-menu-window, .pp__screenshots-files-menu-scrollwrap\").removeClass('open');\r\n                }\r\n            });\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".pp__btn-open-screenshots\").add($(\".pp__screenshots-menu-window, .pp__screenshots-files-menu-scrollwrap, .pp__screenshot-thumbnail-scrollwrap, .pp__resolutions-menu, #pp__modal-add-resolution, #pp__modal-delete-resolution\"))).length == 0 ) {\r\n                    $(\".pp__btn-open-screenshots\").removeClass('active');\r\n                    $(\".pp__screenshots-menu-window, .pp__screenshots-files-menu-scrollwrap, .pp__screenshot-thumbnail-scrollwrap\").removeClass('open');\r\n                }\r\n            });\r\n\r\n            //Добавляем разрешение\r\n            $('#pp__modal-add-resolution .btn-select').on('click', function(event){\r\n                var hasError = false;\r\n                var w = $.trim($('#pp__modal-add-resolution .pp__modal-add-resolution-w').val());\r\n                var h = $.trim($('#pp__modal-add-resolution .pp__modal-add-resolution-h').val());\r\n\r\n                //Проверяем на ошибки\r\n                if(!(/^[1-9]\\w{2,4}$/gim.test(w) && parseInt(w) >= 320 && parseInt(w) <= 99999)) {\r\n                    hasError = true;\r\n                    $('#pp__modal-add-resolution .pp__modal-add-resolution-w-group').addClass(\"has-error\");\r\n                    $('#pp__modal-add-resolution .pp__modal-val-not-digit').css({display: \"block\"});\r\n                }\r\n                if(!(h == \"auto\" || (/^[1-9]\\w{2,4}$/gim.test(h) && parseInt(h) >= 320 && parseInt(h) <= 99999))) {\r\n                    hasError = true;\r\n                    $('#pp__modal-add-resolution .pp__modal-add-resolution-h-group').addClass(\"has-error\");\r\n                    $('#pp__modal-add-resolution .pp__modal-val-not-digit').css({display: \"block\"});\r\n                }\r\n                if(!hasError) {\r\n                    for(var i in session.data.globalSession.resolutions) {\r\n                        var one = session.data.globalSession.resolutions[i];\r\n                        if(parseInt(w) === one.w && (h === \"auto\" || parseInt(h) === one.h)) {\r\n                            hasError = true;\r\n                            $('#pp__modal-add-resolution .pp__modal-add-resolution-w-group').addClass(\"has-error\");\r\n                            $('#pp__modal-add-resolution .pp__modal-add-resolution-h-group').addClass(\"has-error\");\r\n                            $('#pp__modal-add-resolution .pp__modal-val-exists').css({display: \"block\"});\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                //Добавляем страницу\r\n                if(!hasError) {\r\n                    var html =\r\n                    \"<li class='pp__resolutions-list-resolution' data-w='\"+w+\"' data-h='\"+h+\"'>\" +\r\n                        '<div class=\"pp__resolutions-list-resolution-content\">' +\r\n                            '<button class=\"btn btn-default btn-xs btn-block pp__resolutionforscreen-name-btn\">' +\r\n                            '<span class=\"pp__resolutionforscreen-name-btn-w\">'+w+'</span> | <span class=\"pp__resolutionforscreen-name-btn-h\">'+h+'</span>' +\r\n                            '</button>' +\r\n                            '<button class=\"btn btn-default btn-xs pp__resolutions-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                            '<div class=\"btn btn-default btn-xs pp__resolutions-drag-btn\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                        '</div>' +\r\n                        '<ul class=\"pp__resolutions-list-screenshots\"></ul>' +\r\n                    '</li>';\r\n\r\n                    $(\".pp__resolutions-screenshots-list\").prepend(html);\r\n\r\n                    $('#pp__modal-add-resolution .modal').modal('hide');\r\n                }\r\n            });\r\n            $('.pp__add-resolution-btn').on('click', function(){\r\n                $('#pp__modal-add-resolution .pp__modal-val-exists').css({display: \"\"});\r\n                $('#pp__modal-add-resolution .pp__modal-val-not-digit').css({display: \"\"});\r\n                $('#pp__modal-add-resolution .pp__modal-add-resolution-w-group').removeClass(\"has-error\");\r\n                $('#pp__modal-add-resolution .pp__modal-add-resolution-h-group').removeClass(\"has-error\");\r\n                \r\n                $('#pp__modal-add-resolution .modal').modal('show');\r\n            });\r\n\r\n            //Удаляем разрешение\r\n            $('.pp__screenshots-menu').on('click', \" .pp__resolutions-delete-btn\", function(){\r\n                var w = $(this).closest(\".pp__resolutions-list-resolution\").attr(\"data-w\");\r\n                var h = $(this).closest(\".pp__resolutions-list-resolution\").attr(\"data-h\");\r\n                $('#pp__modal-delete-resolution .pp__modal-delete-resolution-w')\r\n                    .attr(\"data-w\", w)\r\n                    .text(w);\r\n                $('#pp__modal-delete-resolution .pp__modal-delete-resolution-h')\r\n                    .attr(\"data-h\", h)\r\n                    .text(h);\r\n                $('#pp__modal-delete-resolution .modal').modal('show');\r\n            });\r\n            $('#pp__modal-delete-resolution .btn-select').on('click', function(){\r\n                var w = $('#pp__modal-delete-resolution .pp__modal-delete-resolution-w').attr(\"data-w\");\r\n                var h = $('#pp__modal-delete-resolution .pp__modal-delete-resolution-h').attr(\"data-h\");\r\n\r\n                $('.pp__screenshots-menu .pp__resolutions-list-resolution[data-w=\"'+w+'\"][data-h=\"'+h+'\"]').remove();\r\n\r\n                $('#pp__modal-delete-resolution .modal').modal('hide');\r\n            });\r\n\r\n            //Привязываем скриншот\r\n            $('.pp__screenshots-files-menu-scrollwrap').on('click', \" .pp__screenshots-btn-add-screenshot\", function(){\r\n                if($(\".pp__screenshots-menu-scrollwrap .pp__resolutions-list-resolution\").length) {\r\n                    var $li = $(this).closest(\".pp__screenshots-item\");\r\n                    var urn = $li.attr(\"data-urn\");\r\n                    var $size = $li.find(\" .pp__screenshots-btn-size\");\r\n                    var w = $size.attr(\"data-w\");\r\n                    var h = $size.attr(\"data-h\");\r\n                    var html = '' +\r\n                        '<li class=\"pp__resolutions-list-screenshot\" data-urn=\"'+urn+'\" data-w=\"'+w+'\" data-h=\"'+h+'\">' +\r\n                            '<div class=\"pp__screenshot-content\">' +\r\n                                '<button class=\"btn btn-default btn-xs btn-block pp__screenshot-name-btn\">' +\r\n                                    '<div class=\"btn btn-default btn-xs pp__resolutions-screenshots-btn-size\" data-w=\"'+w+'\" data-h=\"'+h+'\">' +\r\n                                        '<span class=\"pp__screenshot-name-btn-w\">'+w+'</span> | <span class=\"pp__screenshot-name-btn-h\">'+h+'</span>' +\r\n                                    '</div>' +\r\n                                    urn +\r\n                                '</button>' +\r\n                                '<button class=\"btn btn-default btn-xs pp__resolutions-screenshots-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                                '<div class=\"btn btn-default btn-xs pp__resolutions-screenshots-drag-btn\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                                '<button class=\"pp__resolutions-screenshots-btn-deviation btn btn-default btn-xs\"><i class=\"glyphicon glyphicon-option-vertical\" aria-hidden=\"true\"></i></button>' +\r\n                            '</div>' +\r\n                        '</li>';\r\n\r\n                    $(\".pp__screenshots-menu-scrollwrap .pp__resolutions-list-screenshots\")\r\n                        .first()\r\n                        .prepend($(html).data(\"deviation\", {\r\n                            pos: \"static\",\r\n                            l: \"center\",\r\n                            t: \"top\",\r\n                            lpx: 0,\r\n                            lper: 0,\r\n                            tpx: 0,\r\n                            tper: 0\r\n                        }));\r\n                }\r\n            });\r\n\r\n            //Удаляем (отвязываем) скриншот\r\n            $('.pp__screenshots-menu').on('click', \" .pp__resolutions-screenshots-delete-btn\", function(e){\r\n                e.stopPropagation();\r\n                $(this).closest(\".pp__resolutions-list-screenshot\").remove();\r\n            });\r\n\r\n            //Показываем-скрываем окно \"отклонения\" для скриншота\r\n            $('.pp__screenshots-menu').on('click', \" .pp__resolutions-screenshots-btn-deviation\", function(e){\r\n                var _ = $(this).closest(\".pp__resolutions-list-screenshot\").data(\"deviation\");\r\n                $(\".pp__deviation\").data(\"deviation\", _);\r\n                setParamDeviation($(\".pp__deviation\"), _.pos, _.l, _.t, _.lpx, _.lper, _.tpx, _.tper);\r\n\r\n                $('.pp__deviation').addClass(\"open\");\r\n            });\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".pp__resolutions-screenshots-btn-deviation\").add($(\".pp__deviation\"))).length == 0 ) {\r\n                    $('.pp__deviation').removeClass(\"open\");\r\n                }\r\n            });\r\n\r\n            //Формируем список разрешений с списком привязанных скриншотов\r\n            refreshMenuView();\r\n            function refreshMenuView() {\r\n                var localSession = session.getLocalSessionParams();\r\n                //dragItemList = false;\r\n                var $main = $(\".pp__resolutions-list\");\r\n                $main.empty();\r\n\r\n                if(localSession && \"pages\" in localSession && localSession.pages.currentPage !== null) {\r\n                    var res = (function recursion(resolutions, html) {\r\n                        for(var i in resolutions) {\r\n                            var one = resolutions[i];\r\n                            var w = one.w;\r\n                            var h = one.h;\r\n                            var active = (localSession && \"resolutions\" in localSession && localSession.resolutions.currentResolution.w === w && localSession.resolutions.currentResolution.h === h)?\"active\":\"\";\r\n                            html += \"<li class='pp__resolutions-list-item' data-w='\"+w+\"' data-h='\"+h+\"'>\";\r\n                            html += '<div class=\"pp__resolutions-list-item-content\">' +\r\n                                '<button class=\"btn btn-default btn-xs btn-block pp__resolution-name-btn '+active+'\">' +\r\n                                    '<span class=\"pp__resolution-name-btn-w\">'+w+'</span> | <span class=\"pp__resolution-name-btn-h\">'+h+'</span>' +\r\n                                '</button>' +\r\n                                '</div>';\r\n\r\n                            html += \"</li>\";\r\n                        }\r\n\r\n                        return html;\r\n                    })(session.data.globalSession.resolutions, \"\");\r\n\r\n                    $main.append(res);\r\n                }\r\n            }\r\n\r\n            $(\".pp__screenshots-menu\").prepend(\"<ul class='pp__resolutions-screenshots-list'></ul>\");\r\n            refreshMenuViewScreenshotsForResolutions();\r\n            $(\".pp__resolutions-screenshots-list\").sortable({\r\n                revert: true,\r\n                cursor: 'move',\r\n                axis: 'y',\r\n                items: ' > li',\r\n                distance: 5,\r\n                placeholder: \"placeholder\",\r\n                forceHelperSize: true,\r\n                forcePlaceholderSize: true,\r\n                /*placeholder: {\r\n                    /!*element: function(currentItem) {\r\n                     return $('<div class=\"sm-placeholder-media\"></div>').height( currentItem.outerHeight() );\r\n                     },*!/\r\n                    update: function(container, p) {\r\n                        return;\r\n                    }\r\n                },*/\r\n                stop: function(){\r\n                    //$container.trigger(\"sm.change\");\r\n                }\r\n            });\r\n            var globalScreenshotsRelatedData;\r\n            function refreshMenuViewScreenshotsForResolutions() {\r\n                var localSession = session.getLocalSessionParams();\r\n                globalScreenshotsRelatedData = [];\r\n                //dragItemList = false;\r\n                var $main = $(\".pp__resolutions-screenshots-list\");\r\n                $main.empty();\r\n\r\n                if(localSession && \"pages\" in localSession && localSession.pages.currentPage !== null) {\r\n                    var res = (function recursion(resolutions, html) {\r\n                        for(var i in resolutions) {\r\n                            var one = resolutions[i];\r\n                            var w = one.w;\r\n                            var h = one.h;\r\n                            var active = (localSession && \"resolutions\" in localSession && localSession.resolutions.currentResolution.w === w && localSession.resolutions.currentResolution.h === h)?\"active\":\"\";\r\n                            html += \"<li class='pp__resolutions-list-resolution' data-w='\"+w+\"' data-h='\"+h+\"'>\";\r\n                            html += '<div class=\"pp__resolutions-list-resolution-content\">' +\r\n                                '<button class=\"btn btn-default btn-xs btn-block pp__resolutionforscreen-name-btn '+active+'\">' +\r\n                                    '<span class=\"pp__resolutionforscreen-name-btn-w\">'+w+'</span> | <span class=\"pp__resolutionforscreen-name-btn-h\">'+h+'</span>' +\r\n                                '</button>' +\r\n                                '<button class=\"btn btn-default btn-xs pp__resolutions-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                                '<div class=\"btn btn-default btn-xs pp__resolutions-drag-btn\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                                '</div>';\r\n\r\n\r\n                            html += \"<ul class='pp__resolutions-list-screenshots'>\" + createScreenshotsList(localSession.pages.currentPage, one, session.data.globalSession.designScreenshotsRelatedResolutionAndPage) + \"</ul>\";\r\n\r\n                            html += \"</li>\";\r\n                        }\r\n\r\n                        return html;\r\n                    })(session.data.globalSession.resolutions, \"\");\r\n\r\n                    $main.append(res);\r\n\r\n                    var i = 0;\r\n                    $main.find(\" .pp__resolutions-list-screenshot\").each(function() {\r\n                        $(this).data(\"deviation\", globalScreenshotsRelatedData[i]);\r\n                        i++;\r\n                    });\r\n                }\r\n                refreshSortableScreensotsInResolutions();\r\n            }\r\n            createDeviation();\r\n            function createDeviation() {\r\n                var html = '' +\r\n                    '<div class=\"pp__deviation panel panel-primary\">' +\r\n                    '<div class=\"panel-body\">' +\r\n                    '<div class=\"row\">' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-left\">' +\r\n                    '<form class=\"pp__deviation-fixed-or-static btn-group-vertical btn-toggle-one-color\" data-toggle=\"buttons\">' +\r\n                    '<label class=\"btn\" data-btn-color=\"primary\">' +\r\n                    '<input type=\"radio\" name=\"sm-radio-fixed-or-static\" value=\"1\" />Static' +\r\n                    '</label>' +\r\n                    '<label class=\"btn\" data-btn-color=\"danger\">' +\r\n                    '<input type=\"radio\" name=\"sm-radio-fixed-or-static\" value=\"0\" />Fixed' +\r\n                    '</label>' +\r\n                    '</form>' +\r\n                    '</div>' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-right\">' +\r\n                    '<div class=\"pp__deviation-relative btn-group-table\">' +\r\n                    '<div class=\"btn-group btn-group-justified\" role=\"group\">' +\r\n                    '<div class=\"btn\" data-left=\"left\" data-top=\"top\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn\" data-left=\"center\" data-top=\"top\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn\" data-left=\"right\" data-top=\"top\" role=\"button\">&nbsp</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"btn-group btn-group-justified\" role=\"group\">' +\r\n                    '<div class=\"btn disabled\" data-left=\"left\" data-top=\"center\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn disabled\" data-left=\"center\" data-top=\"center\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn disabled\" data-left=\"right\" data-top=\"center\" role=\"button\">&nbsp</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"btn-group btn-group-justified\" role=\"group\">' +\r\n                    '<div class=\"btn disabled\" data-left=\"left\" data-top=\"bottom\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn disabled\" data-left=\"center\" data-top=\"bottom\" role=\"button\">&nbsp</div>' +\r\n                    '<div class=\"btn disabled\" data-left=\"right\" data-top=\"bottom\" role=\"button\">&nbsp</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"row row-name-px-percent\">' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-left\">' +\r\n                    '<p>px</p>' +\r\n                    '</div>' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-right\">' +\r\n                    '<p>%</p>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"row row-otklonenie-1\">' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-left\">' +\r\n                    '<div class=\"input-group\">' +\r\n                    '<input type=\"text\" class=\"form-control input-sm pp__deviation-input pp__deviation-left-px\">' +\r\n                    '<div class=\"input-group-addon\"><span class=\"fa fa-long-arrow-right\"></span></div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-right\">' +\r\n                    '<div class=\"input-group\">' +\r\n                    '<input type=\"text\" class=\"form-control input-sm pp__deviation-input pp__deviation-left-percent\">' +\r\n                    '<div class=\"input-group-addon\"><span class=\"fa fa-long-arrow-right\"></span></div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"row row-otklonenie-2\">' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-left\">' +\r\n                    '<div class=\"input-group\">' +\r\n                    '<input type=\"text\" class=\"form-control input-sm pp__deviation-input pp__deviation-top-px\">' +\r\n                    '<div class=\"input-group-addon\">&nbsp<span class=\"fa fa-long-arrow-down\"></span>&nbsp</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '<div class=\"col-xs-6 pp__deviation-col-right\">' +\r\n                    '<div class=\"input-group\">' +\r\n                    '<input type=\"text\" class=\"form-control input-sm pp__deviation-input pp__deviation-top-percent\">' +\r\n                    '<div class=\"input-group-addon\">&nbsp<span class=\"fa fa-long-arrow-down\"></span>&nbsp</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div>';\r\n                $(\".pp__screenshots-menu-window\").append(html);\r\n                refreshSpinner($(\".pp__deviation\"));\r\n            }\r\n            function setParamDeviation($container, pos, l, t, lpx, lper, tpx, tper) {\r\n                var $static = $container.find(\" .pp__deviation-fixed-or-static label\").first();\r\n                var $fixed = $container.find(\" .pp__deviation-fixed-or-static label\").last();\r\n                if(pos == \"static\") {\r\n                    $static.removeClass(\"btn-default\").addClass(\"btn-primary active\");\r\n                    $static.find(\" input\").prop(\"checked\", true);\r\n                    $fixed.addClass(\"btn-default\").removeClass(\"btn-danger active\");\r\n                    $fixed.find(\" input\").prop(\"checked\", false);\r\n                } else {\r\n                    $static.addClass(\"btn-default\").removeClass(\"btn-primary active\");\r\n                    $static.find(\" input\").prop(\"checked\", false);\r\n                    $fixed.removeClass(\"btn-default\").addClass(\"btn-danger active\");\r\n                    $fixed.find(\" input\").prop(\"checked\", true);\r\n                }\r\n\r\n                var $relative = $container.find(\" .pp__deviation-relative\");\r\n                if(pos == \"static\") {\r\n                    $relative.addClass(\"pp__deviation-static\").removeClass(\"pp__deviation-fixed\");\r\n                    $relative.find(\" .btn[data-top!='top']\").addClass(\"disabled\");\r\n                } else {\r\n                    $relative.removeClass(\"pp__deviation-static\").addClass(\"pp__deviation-fixed\");\r\n                    $relative.find(\" .btn[data-top!='top']\").removeClass(\"disabled\");\r\n                }\r\n                $relative.find(\" .btn\").removeClass(\"active btn-danger\").addClass(\"btn-default\");\r\n                $relative.find(\" .btn[data-left='\"+l+\"'][data-top='\"+t+\"']\").addClass(\"active btn-danger\").removeClass(\"btn-default\");\r\n\r\n                var deviationInput = $container.find(\" .pp__deviation-input\");\r\n                deviationInput.filter(\".pp__deviation-left-px\").val(lpx);\r\n                deviationInput.filter(\".pp__deviation-left-percent\").val(lper);\r\n                deviationInput.filter(\".pp__deviation-top-px\").val(tpx);\r\n                deviationInput.filter(\".pp__deviation-top-percent\").val(tper);\r\n            }\r\n            //Обновить спиннер\r\n            function refreshSpinner($container) {\r\n                $container.find(\" .pp__deviation-left-px\").add($container.find(\" .pp__deviation-top-px\")).spinner({\r\n                    min: -99999,\r\n                    max: 99999,\r\n                    start: function(){\r\n\r\n                    },\r\n                    spin: function(){\r\n\r\n                    },\r\n                    stop: function(){\r\n\r\n                    }\r\n                });\r\n                $container.find(\" .pp__deviation-left-percent\").add($container.find(\" .pp__deviation-top-percent\")).spinner({\r\n                    min: -9999,\r\n                    max: 9999,\r\n                    step: 0.1,\r\n                    start: function(){\r\n\r\n                    },\r\n                    spin: function(){\r\n\r\n                    },\r\n                    stop: function(){\r\n\r\n                    }\r\n                });\r\n            }\r\n                //Вывод привязанных скриншотов\r\n                function createScreenshotsList(currentPage, resolution, screenshotsRelated) {\r\n                    if(currentPage in screenshotsRelated && (resolution.w+\"|\"+resolution.h) in  screenshotsRelated[currentPage]) {\r\n                        //nestet to object list\r\n                        var screenshotsObjList = session.getScreenshotsObjList();\r\n\r\n                        var screenshots = screenshotsRelated[currentPage][resolution.w+\"|\"+resolution.h];\r\n                        var html = \"\";\r\n                        for(var key in screenshots) {\r\n                            var s =  screenshots[key];//screenshot\r\n\r\n                            if(s.pos == \"static\") {\r\n                                s.t = \"top\";\r\n                            }\r\n                            globalScreenshotsRelatedData.push({\r\n                                pos: s.pos,\r\n                                l: s.l,\r\n                                t: s.t,\r\n                                lpx: s.lpx,\r\n                                lper: s.lper,\r\n                                tpx: s.tpx,\r\n                                tper: s.tper\r\n                            });\r\n                            //html += (s.urn, s.active, screenshotsObjList[s.urn].w, screenshotsObjList[s.urn].h, s.pos, s.l, s.t, s.lpx, s.lper, s.tpx, s.tper);++++++++++++++++++\r\n                            html += '' +\r\n                            '<li class=\"pp__resolutions-list-screenshot\" data-urn=\"'+s.urn+'\" data-w=\"'+screenshotsObjList[s.urn].w+'\" data-h=\"'+screenshotsObjList[s.urn].h+'\">' +\r\n                                '<div class=\"pp__screenshot-content\">' +\r\n                                    '<button class=\"btn btn-default btn-xs btn-block pp__screenshot-name-btn '+((s.active)?\"active\":\"\")+'\">' +\r\n                                        '<div class=\"btn btn-default btn-xs pp__resolutions-screenshots-btn-size\" data-w=\"'+screenshotsObjList[s.urn].w+'\" data-h=\"'+screenshotsObjList[s.urn].h+'\">' +\r\n                                            '<span class=\"pp__screenshot-name-btn-w\">'+screenshotsObjList[s.urn].w+'</span> | <span class=\"pp__screenshot-name-btn-h\">'+screenshotsObjList[s.urn].h+'</span>' +\r\n                                        '</div>' +\r\n                                        s.urn +\r\n                                    '</button>' +\r\n                                    '<button class=\"btn btn-default btn-xs pp__resolutions-screenshots-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                                    '<div class=\"btn btn-default btn-xs pp__resolutions-screenshots-drag-btn\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                                    '<button class=\"pp__resolutions-screenshots-btn-deviation btn btn-default btn-xs\"><i class=\"glyphicon glyphicon-option-vertical\" aria-hidden=\"true\"></i></button>' +\r\n                                '</div>' +\r\n                            '</li>';\r\n                        }\r\n                        return html;\r\n                    }\r\n                    return \"\";\r\n                }\r\n                //Просто обновляем сортировку\r\n                function refreshSortableScreensotsInResolutions() {\r\n                    $(\".pp__resolutions-list-screenshots\").sortable({\r\n                        revert: true,\r\n                        cursor: 'move',\r\n                        axis: 'y',\r\n                        items: ' > li',\r\n                        distance: 5,\r\n                        connectWith: \".pp__resolutions-list-screenshots\",\r\n                        placeholder: \"placeholder\",\r\n                        forceHelperSize: true,\r\n                        forcePlaceholderSize: true,\r\n                        /*placeholder: {\r\n                            element: function(currentItem) {\r\n                                return $('<div class=\"panel panel-default sm-placeholder-scrin\"></div>').height( currentItem.outerHeight() );\r\n                            },\r\n                            update: function(container, p) {\r\n                                return;\r\n                            }\r\n                        },*/\r\n                        remove: function(event, ui){//\"update\" заменил на \"remove\"\r\n                            /*if( ui.item.closest( \".sm-all-scrins\" ).size() ) {\r\n                                ui.item.remove();\r\n                            }*/\r\n                        },\r\n                        stop: function(){\r\n                            //$container.trigger(\"sm.change\");\r\n                        }\r\n                    });\r\n                }\r\n\r\n            //Список всех скриншотов\r\n            $(\".pp__screenshots-files-menu-scrollwrap\").prepend('<ul class=\"pp__screenshots-files-list\"></ul>');\r\n            refreshMenuAllScreenshots();\r\n            function refreshMenuAllScreenshots() {\r\n                var localSession = session.getLocalSessionParams();\r\n                //dragItemList = false;\r\n                var $main = $(\".pp__screenshots-files-list\");\r\n                $main.empty();\r\n\r\n                var res = (function recursion(el, html) {\r\n                    //li\r\n                    for(var i in el) {\r\n                        var one = el[i];\r\n                        //\r\n                        var collapsedToObj = {};\r\n                        for(key in session.data.globalSession.designScreenshotsFoldersUncollapsed) {\r\n                            collapsedToObj[session.data.globalSession.designScreenshotsFoldersUncollapsed[key]] = true;\r\n                        }\r\n                        var _class = (one.type == \"file\")?\"file\":\"folder btn-yellow\";\r\n                        html += \"<li class='pp__screenshots-item \"+((one.urn in collapsedToObj)?\"\":\"collapsed\")+\"' data-type='\"+one.type+\"' data-name='\"+one.name+\"' data-urn='\"+one.urn+\"'>\";\r\n                        html += '<div class=\"pp__screenshots-item-content\">' +\r\n                            '<button class=\"btn btn-default btn-xs pp__screenshots-btn-collapsed\"><span class=\"glyphicon glyphicon-minus\"></span><span class=\"glyphicon glyphicon-plus\"></span></button>' +\r\n                            '<div class=\"btn btn-default btn-xs btn-block pp__screenshots-btn-name pp__screenshots-btn-'+_class+'\">' +\r\n                                ((one.type == \"file\")?\r\n                                '<div class=\"btn btn-default btn-xs pp__screenshots-btn-size\" data-w=\"'+one.w+'\" data-h=\"'+one.h+'\">' +\r\n                                    '<span class=\"pp__screenshots-btn-size-w\">'+one.w+'</span> | <span class=\"pp__screenshots-btn-size-h\">'+one.h+'</span>' +\r\n                                '</div>':\"\") +\r\n                            one.name +\r\n                            '</div>' +\r\n                            ((one.type == \"file\")?'<button class=\"btn btn-success btn-xs pp__screenshots-btn-add-screenshot\"><span class=\"glyphicon glyphicon-plus-sign\"></span></button>':\"\") +\r\n                            '</div>';\r\n\r\n                        //sub\r\n                        if(\"sub\" in one) {\r\n                            html = recursion(one.sub, html+\"<ul>\")+\"</ul>\";\r\n                        }\r\n                        //sub (end)\r\n\r\n                        html += \"</li>\";\r\n\r\n                    }\r\n                    //li (end)\r\n\r\n                    return html;\r\n                })(session.data.globalSession.designScreenshots, \"\");\r\n\r\n                $main.append(res);\r\n                refreshMenuAllScreenshots__specific($(\".pp__screenshots-files-menu-scrollwrap\"));\r\n            }\r\n                //для вложенных добавляем класс \"have-nested\", удаляем \"collapsed\" для тех кто без вложенных, коллапсируем рассколапсируем\r\n                function refreshMenuAllScreenshots__specific($main) {\r\n                    //Вставляем класс для вложенных\r\n                    $main.find(\" .pp__screenshots-item\").removeClass(\"have-nested\");\r\n                    $main.find(\" ul\").each(function() {\r\n                        if($(this).parent(\".pp__screenshots-item\").length) {\r\n                            $(this).parent(\".pp__screenshots-item\").addClass(\"have-nested\");\r\n                        }\r\n                    });\r\n                    //\r\n                    $main.find(\" .pp__screenshots-item\").each(function() {\r\n                        if(!$(this).hasClass(\"have-nested\")) {\r\n                            $(this).removeClass(\"collapsed\");\r\n                        }\r\n                    });\r\n                    //Коллапсируем рассколапсируем\r\n                    $main.find(\" .pp__screenshots-item.collapsed > ul\").css({display: \"none\"});\r\n                    $main.find(\" .pp__screenshots-item > ul\").not($main.find(\" .pp__screenshots-item.collapsed > ul\")).css({display: \"block\"});\r\n                }\r\n                //коллапсировать-рассколапсировать\r\n                $(\".pp__screenshots-files-list\").on(\"click\", \" .pp__screenshots-btn-collapsed\", function(){\r\n                    var $item = $(this).closest(\".pp__screenshots-item\");\r\n                    if( $item.hasClass(\"collapsed\") ) {\r\n                        $item.removeClass(\"collapsed\")\r\n                            .find(\" > ul\").css({display: \"block\"});\r\n                    } else {\r\n                        $item.addClass(\"collapsed\")\r\n                            .find(\" > ul\").css({display: \"none\"});\r\n                    }\r\n                });\r\n\r\n            //Отображаем миниатюрку\r\n            var windowThumbnail__timeoutId = null;\r\n            $(\".pp__screenshots-files-menu-scrollwrap\").on(\"mouseenter\", \" .pp__screenshots-item[data-type='file']\", function(){\r\n                $(\".pp__screenshot-thumbnail\")\r\n                    .empty()\r\n                    .append('<img src=\"'+(\"/design-screenshots/design-thumbnails/\"+$(this).attr(\"data-urn\"))+'\" width=\"320\" height=\"auto\" />');\r\n                $(\".pp__screenshot-thumbnail-scrollwrap\").addClass(\"open\");\r\n                $(\".pp__screenshots-files-menu-scrollwrap\").addClass(\"shadow-hidden\");\r\n            });\r\n            //Скрываем только при уводе с блоков \".pp__screenshots-files-menu-scrollwrap, .pp__screenshot-thumbnail-scrollwrap\" на другой\r\n            $(\".pp__screenshots-files-menu-scrollwrap, .pp__screenshot-thumbnail-scrollwrap\").on({\r\n                \"mouseenter\": function() {\r\n                    if(windowThumbnail__timeoutId !== null) {\r\n                        clearTimeout(windowThumbnail__timeoutId);\r\n                    }\r\n                },\r\n                \"mouseleave\": function() {\r\n                    windowThumbnail__timeoutId = setTimeout(function() {\r\n                        windowThumbnail__timeoutId = null;\r\n                        $(\".pp__screenshot-thumbnail-scrollwrap\").removeClass(\"open\");\r\n                        $(\".pp__screenshots-files-menu-scrollwrap\").removeClass(\"shadow-hidden\");\r\n                    }, 10);\r\n                }\r\n            });\r\n\r\n            //Сменяем разрешение\r\n            $('.shab__top-menu').on('change', ' .select-group', function() {\r\n                var $optionSelected = $('.shab__top-menu .select-group option:selected');\r\n                pixelPerfect.selectSize( $optionSelected.attr('data-width'), $optionSelected.attr('data-height') );\r\n            });\r\n\r\n            //Показать верстку или скрины или 50 на 50\r\n            $('.pp__verstka-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(0);\r\n                refreshButtonsPageProofsOrDesign();\r\n            });\r\n            $('.pp__50p-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(1);\r\n                refreshButtonsPageProofsOrDesign();\r\n            });\r\n            $('.pp__design-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(2);\r\n                refreshButtonsPageProofsOrDesign();\r\n            });\r\n\r\n            //Горячие клавишы\r\n            pageManagerVisualizator.$container.on( \"pmv.load.iframe\", function(){\r\n                $('body')\r\n                    .add( $('#'+(pageManagerVisualizator._options.nameIFrame)).contents().find(\"body\") )\r\n                    .on('keydown', function(e) {\r\n                        if(e.which == 81 && e.ctrlKey && !e.shiftKey && !e.altKey)//(e.which == 65 || e.which == 83 || e.which == 68)\r\n                        {\r\n                            if($('.pp__50p-btn, .pp__design-btn').hasClass('active'))\r\n                            {\r\n                                pixelPerfect.showPageProofsOrDesign(0);\r\n                            }\r\n                            else\r\n                            {\r\n                                pixelPerfect.showPageProofsOrDesign(1);\r\n                            }\r\n\r\n                            e = e || window.e; if (e.stopPropagation) {e.stopPropagation()} else {e.cancelBubble = true} e.preventDefault();\r\n                        }\r\n                    });\r\n            });\r\n\r\n            //Обновить кнопки\r\n            function refreshButtonsPageProofsOrDesign(show) {\r\n                $('.pp__verstka-design .btn').removeClass(\"active btn-primary btn-success btn-info btn-warning btn-danger\").addClass(\"btn-default\");\r\n                switch (show) {\r\n                    case 0:\r\n                        $('.pp__verstka-btn').removeClass(\"btn-default\").addClass(\"active btn-primary\");\r\n                        break;\r\n                    case 1:\r\n                        $('.pp__50p-btn').removeClass(\"btn-default\").addClass(\"active btn-warning\");\r\n                        break;\r\n                    case 2:\r\n                        $('.pp__design-btn').removeClass(\"btn-default\").addClass(\"active btn-danger\");\r\n                        break;\r\n                }\r\n            }\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Для тестов*/\r\n        /****************************************************/\r\n        $(document).ready(function(){\r\n            $('#testovaya_ssilka').on('click', function(event){\r\n\r\n            });\r\n        });\r\n\r\n        /****************************************************/\r\n        /*Вспомогательная хрень*/\r\n        /****************************************************/\r\n        $(document).ready(function(){\r\n            //Подсказки\r\n            $('[data-toggle=\"tooltip\"]').tooltip();\r\n            $('[data-toggle=\"popover\"]').popover();\r\n            //==========\r\n        });\r\n    }\r\n});\r\n\r\n"]}