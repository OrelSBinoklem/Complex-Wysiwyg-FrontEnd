{"version":3,"sources":["js/main.js"],"names":["jQuery","$","next","openOptions","animations","openOptionsTimeLine__close","pause","css","display","opacity","transform","openOptionsTimeLine","restart","TimelineLite","append","TweenMax","to","addClass","closeOptions","handlerComplete","onComplete","removeClass","on","this","hasClass","e","target","closest","add","size","refreshMenuView","session","sessionGroupSynchronizations","length","activeGroups","haveCookie","undefined","cookie","secureEvalJSON","groups","sessionGroupsForNames","key","one","name","filter","item","i","arr","toJSON","removeCookie","activeGroupsObj","html","oneGroup","activeParamsObj","synchroParams","active","empty","prepend","sortable","axis","items","disableSelection","modal","val","trim","alert","attr","text","remove","handlerAddPage","urn","console","log","localSession","getLocalSessionParams","dragItemList","$main","res","recursion","el","type","_class","pages","currentPage","collapsed","sub","globalSession","find","nestedSortable","forcePlaceholderSize","handle","placeholder","revert","tabSize","toleranceElement","listType","helper","maxLevels","isTree","start","stop","update","event","ui","clearEmptyUl","refreshNestedEl","clearCollapseNotNested","data","pagesNestedToJson","savePages","refreshCollapsed","json","previousLevel","stack","0","each","level","parents","obj","push","itemToJson","$item","parent","not","pageManagerVisualizator","modules","$mapNavigatorContainer","nameIFrame","pixelsScrollableInSeconds","minWOuterScroll","minHOuterScroll","minWDraggable","minHDraggable","minWIFrame","minHIFrame","responsiveToMovementOfTheCursorInAConfinedSpace","movementOfTheCursorInAConfinedSpaceSpred","gorizontalFixation","verticalFixation","mCustomScrollbar","theme","scrollbarPosition","scrollInertia","mouseWheel","scrollAmount","callbacks","onUpdate","toggleClass","handlerSelectPage","changePage","page","selectPage","_options","window","location","href","input","get","focus","stopPropagation","confirm","removePage","reloadPage","$container","pmv.prepaste.iframe","width","height","pmv.load.iframe","setTimeout","_create","document","ready","tooltip","popover","which","altKey","cancelBubble","preventDefault","socket","io","connect","once","sessionModel"],"mappings":"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","file":"main.js","sourcesContent":["/****************************************************/\r\n/*Шаблонизатор*/\r\n/****************************************************/\r\njQuery(function($) {\r\n    $(\"body\").on('keydown', function(e) {\r\n        if(e.which == 49 && e.altKey)//(e.which == 65 || e.which == 83 || e.which == 68)\r\n        {\r\n            e = e || window.e; if (e.stopPropagation) {e.stopPropagation()} else {e.cancelBubble = true} e.preventDefault();\r\n        }\r\n    });\r\n\r\n    var session;\r\n    var socket = io.connect('/');\r\n\r\n    socket.once('session.load', function (data) {\r\n        session = new modules.sessionModel(data, socket);\r\n        //console.log(data);\r\n        next();\r\n    });\r\n\r\n    function next() {\r\n        //Глобальные настройки\r\n        (function() {\r\n            var animations = {};\r\n            $( \".shab__global-settings-btn\" ).on(\"click\", function () {\r\n                if( !$(this).hasClass('active') ) {\r\n                    openOptions();\r\n                } else {\r\n                    closeOptions();\r\n                }\r\n            });\r\n\r\n            $( \"body\" ).on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".shab__global-settings-btn\").add($(\".shab__global-settings\"))).size() == 0 ) {\r\n                    if( $(\".shab__global-settings-btn\").hasClass('active') ) {\r\n                        closeOptions();\r\n                    }\r\n                }\r\n            });\r\n\r\n            function openOptions() {\r\n                if( \"openOptionsTimeLine__close\" in animations ) { animations.openOptionsTimeLine__close.pause() }\r\n                $(\" .shab__global-settings\").css({\r\n                    display: \"block\",\r\n                    opacity: 0,\r\n                    transform: \"scale(0.8, 0.8)\"\r\n                });\r\n\r\n                if( !(\"openOptionsTimeLine\" in animations) ) {\r\n                    animations.openOptionsTimeLine = (new TimelineLite()).append([\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{transform: \"scale(1, 1)\" }}),\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.3,\r\n                            {css:{ opacity: 1 }})\r\n                    ]);\r\n                } else {\r\n                    animations.openOptionsTimeLine.restart();\r\n                }\r\n\r\n                $( \".shab__global-settings-btn\" ).addClass('active');\r\n            }\r\n\r\n            function closeOptions() {\r\n                if( \"openOptionsTimeLine\" in animations ) { animations.openOptionsTimeLine.pause() }\r\n                if( !(\"openOptionsTimeLine__close\" in animations) ) {\r\n                    animations.openOptionsTimeLine__close = (new TimelineLite()).append([\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{ transform: \"scale(0.8, 0.8)\"}, onComplete: handlerComplete}),\r\n                        TweenMax.to($(\".shab__global-settings\"), 0.5,\r\n                            {css:{ opacity: 0 }})\r\n                    ]);\r\n                } else {\r\n                    animations.openOptionsTimeLine__close.restart();\r\n                }\r\n                function handlerComplete() {\r\n                    $(\".shab__global-settings\").css('display', 'none');\r\n                }\r\n\r\n                $( \".shab__global-settings-btn\" ).removeClass('active');\r\n            }\r\n\r\n            //$('#text-encoding-server').selectpicker();\r\n\r\n            //Кодировка на хосте\r\n            //$('#text-encoding-server').selectpicker('val', shablonizator.settings.find('text_encoding_server').text());\r\n\r\n            /*$('#text-encoding-server').on('change', function(){\r\n                shablonizator.textEncodingServer = $(this).val();\r\n                shablonizator.settings.find('text_encoding_server').text($(this).val());\r\n                shablonizator.save_g_settings();\r\n            });*/\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Синхронизация по группам сессий*/\r\n        /****************************************************/\r\n        (function() {\r\n            //Свернуть-развернуть список выбора групп\r\n            $(\".shab__btn-open-groups-session\").on(\"click\", function () {\r\n                if(!$(this).hasClass('active')) {\r\n                    $(this).addClass('active');\r\n                    $(\".shab__session-groups-list\").addClass('open');\r\n                } else {\r\n                    $(this).removeClass('active');\r\n                    $(\".shab__session-groups-list\").removeClass('open');\r\n                }\r\n            });\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".shab__btn-open-groups-session\").add($(\".shab__session-groups-list\")).add($(\"#shab-add-group-session\")).add($(\"#shab-delete-group-session\"))).length == 0 ) {\r\n                    $(\".shab__btn-open-groups-session\").removeClass('active');\r\n                    $(\".shab__session-groups-list\").removeClass('open');\r\n                }\r\n            });\r\n\r\n            //Формирование меню групп сессий\r\n            $(\".shab__session-groups-list\").prepend(\"<ul class='shab__session-groups-list-ul'></ul>\");\r\n            refreshMenuView();\r\n            $(\".shab__session-groups-list-ul\").sortable({\r\n                    axis: \"y\",\r\n                    //handle: 'button',\r\n                    items: \"> li\"\r\n                })\r\n                .disableSelection();\r\n            function refreshMenuView() {\r\n                if(session.sessionGroupSynchronizations.length) {\r\n                    var haveCookie = $.cookie('adaptive_pixel_perfect_groups_session') !== undefined;\r\n                    var activeGroups;\r\n\r\n                    if(haveCookie) {\r\n                        activeGroups = $.secureEvalJSON($.cookie('adaptive_pixel_perfect_groups_session')).groups;\r\n                        //список в обьект по именам групп сессий\r\n                        var sessionGroupsForNames = {};\r\n                        for(var key in session.sessionGroupSynchronizations) {\r\n                            var one = session.sessionGroupSynchronizations[key];\r\n                            sessionGroupsForNames[one.name] = one;\r\n                        }\r\n\r\n                        //Удаляем имена выбранных групп которых уже нету\r\n                        activeGroups.filter(function(item, i, arr) {\r\n                            return item in sessionGroupsForNames;\r\n                        });\r\n                        $.cookie('adaptive_pixel_perfect_groups_session', $.toJSON({\"groups\": activeGroups}));\r\n                        if(!activeGroups.length) {\r\n                            $.removeCookie('adaptive_pixel_perfect_groups_session');\r\n                            haveCookie = false;\r\n                            activeGroups = [];\r\n                        }\r\n                    }\r\n                    var activeGroupsObj = {};\r\n                    for(var i in activeGroups) {\r\n                        activeGroupsObj[activeGroups[i]] = true;\r\n                    }\r\n\r\n                    //Формируем меню\r\n                    var html = \"\";\r\n\r\n                    for(var key in session.sessionGroupSynchronizations) {\r\n                        var oneGroup = session.sessionGroupSynchronizations[key];\r\n\r\n                        var activeParamsObj = {};\r\n                        for(var i in oneGroup.synchroParams) {\r\n                            activeParamsObj[oneGroup.synchroParams[i]] = true;\r\n                        }\r\n\r\n                        var active = (haveCookie && (oneGroup.name in activeGroupsObj))?\"active\":\"\";\r\n                        html += '<li class=\"shab__session-groups-list-item '+active+'\" data-name=\"'+(oneGroup.name)+'\">' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"pages\"       in activeParamsObj)?\"active\":\"\")+'\" data-param=\"pages\"><i class=\"fa fa-file-o\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"resolutions\" in activeParamsObj)?\"active\":\"\")+'\" data-param=\"resolutions\"><i class=\"fa fa-arrows\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn '+((\"iframe\"      in activeParamsObj)?\"active\":\"\")+'\" data-param=\"iframe\"><i class=\"fa fa-desktop\"></i></button>' +\r\n                            '<button class=\"btn btn-default btn-xs btn-block shab__session-groups-list-btn '+active+'\">'+(oneGroup.name)+'</button>' +\r\n                            '<div class=\"btn btn-default btn-xs shab__session-groups-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                            '<button class=\"btn btn-default btn-xs shab__session-groups-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                            '</li>';\r\n                    }\r\n\r\n                    $(\".shab__session-groups-list-ul\").empty().append(html);\r\n                } else {\r\n                    if($.cookie('adaptive_pixel_perfect_groups_session') !== undefined) {\r\n                        $.removeCookie('adaptive_pixel_perfect_groups_session');\r\n                    }\r\n                }\r\n            }\r\n\r\n            //Добавить группу\r\n            $('.shab__add-group-session').on('click', function(){\r\n                $('#shab-add-group-session .modal').modal('show');\r\n            });\r\n            $('#shab-add-group-session .btn-select').on('click', function(){\r\n                var name = $('#shab-add-group-session .shab-add-group-session__name').val();\r\n                if($.trim(name)) {\r\n                    var html = '<li class=\"shab__session-groups-list-item\" data-name=\"'+($.trim(name))+'\">' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"pages\"><i class=\"fa fa-file-o\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"resolutions\"><i class=\"fa fa-arrows\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-synchro-params-btn\" data-param=\"iframe\"><i class=\"fa fa-desktop\"></i></button>' +\r\n                        '<button class=\"btn btn-default btn-xs btn-block shab__session-groups-list-btn\">'+($.trim(name))+'</button>' +\r\n                        '<div class=\"btn btn-default btn-xs shab__session-groups-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                        '<button class=\"btn btn-default btn-xs shab__session-groups-delete-btn\"><span class=\"glyphicon glyphicon-remove\"></span></button>' +\r\n                        '</li>';\r\n                    $(\".shab__session-groups-list-ul\").append(html);\r\n                } else {\r\n                    alert(\"Имя недолжно быть пустым\");\r\n                }\r\n                $('#shab-add-group-session .modal').modal('hide');\r\n            });\r\n\r\n            //Удалить группу\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-delete-btn\", function(){\r\n                $('#shab-delete-group-session .modal').modal('show');\r\n\r\n                var name = $(this).closest(\".shab__session-groups-list-item\").attr(\"data-name\");\r\n                $('#shab-delete-group-session .shab-delete-group-session__name')\r\n                    .attr(\"data-name\", name)\r\n                    .text(name);\r\n            });\r\n            $('#shab-delete-group-session .btn-select').on('click', function(){\r\n                var name = $('#shab-delete-group-session .shab-delete-group-session__name').attr(\"data-name\");\r\n                $(\".shab__session-groups-list-item[data-name='\"+name+\"']\").remove();\r\n\r\n                $('#shab-delete-group-session .modal').modal('hide');\r\n            });\r\n\r\n            //Активировать-деактивировать группу\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-list-btn\", function(){\r\n                if($(\".shab__session-groups-list.open\").length) {\r\n                    if(!$(this).hasClass(\"active\")) {\r\n                        $(this).addClass(\"active\")\r\n                            .closest(\".shab__session-groups-list-item\").addClass(\"active\");\r\n                    } else {\r\n                        $(this).removeClass(\"active\")\r\n                            .closest(\".shab__session-groups-list-item\").removeClass(\"active\");\r\n                    }\r\n                }\r\n            });\r\n\r\n            //Активировать-деактивировать параметр группы\r\n            $('.shab__session-groups-list').on('click', \" .shab__session-groups-synchro-params-btn\", function(){\r\n                if(!$(this).hasClass(\"active\")) {\r\n                    $(this).addClass(\"active\");\r\n                } else {\r\n                    $(this).removeClass(\"active\");\r\n                }\r\n            });\r\n\r\n            \r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Менеджер страниц и визуализатор*/\r\n        /****************************************************/\r\n        (function() {\r\n            pageManagerVisualizator = new modules.pageManagerVisualizator($(\"#wrap_iframe\"), session, {\r\n                $mapNavigatorContainer: $('.mnif__navigator-window'),\r\n                nameIFrame: \"PP_iframe\",\r\n                pixelsScrollableInSeconds: 2000,\r\n                minWOuterScroll: 23,\r\n                minHOuterScroll: 23,\r\n                minWDraggable: 15,\r\n                minHDraggable: 15,\r\n                minWIFrame: 320,\r\n                minHIFrame: 480,\r\n                responsiveToMovementOfTheCursorInAConfinedSpace: true,\r\n                movementOfTheCursorInAConfinedSpaceSpred: 10,\r\n                gorizontalFixation: \"center\",\r\n                verticalFixation: \"top\"\r\n            });\r\n\r\n            //Скроллбар для списка страниц\r\n            $(\".pmv__pages-sortable-scrollwrap\").mCustomScrollbar({\r\n                axis: \"y\",\r\n                theme: \"dark\",\r\n                scrollbarPosition: \"outside\",\r\n                scrollInertia: 100,\r\n                mouseWheel: {\r\n                    scrollAmount: 100\r\n                },\r\n                callbacks: {\r\n                    onUpdate: function() {\r\n                        if($(\".pmv__pages-sortable-scrollwrap\").hasClass(\"_mCS_1 mCS_no_scrollbar\")) {\r\n                            $(\".pmv__pages-window\").addClass(\"no-scrollbar\");\r\n                        } else {\r\n                            $(\".pmv__pages-window\").removeClass(\"no-scrollbar\");\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            //Открыть-закрыть меню выбора страниц\r\n            $(\".pmv__select-page-open-list\").on(\"click\", function () {\r\n                $(this).toggleClass('active');\r\n            });\r\n            var dragItemList = false;\r\n            $(\"body\").on(\"click click.body.iframe\", function (e) {\r\n                if( $(e.target).closest($(\".pmv__select-page-open-list\").add($(\".pmv__pages-window\")).add($(\"#modal-pmv-add-page-href\"))).length == 0 && !dragItemList ) {\r\n                    $(\".pmv__select-page-open-list\").removeClass('active');\r\n                }\r\n            });\r\n\r\n            //Сменяем страницу\r\n            $('.pmv__pages-sortable').on('click', ' .pmv__pages-btn-page', function() {\r\n                $(\".pmv__pages-btn-page\").removeClass(\"active\");\r\n                $(this).addClass(\"active\");\r\n                pageManagerVisualizator.handlerSelectPage( $(this).closest(\".pmv__pages-item\").attr(\"data-name\") );\r\n                if( $(\".pmv__select-page-open-list\").hasClass('active') ) {\r\n                    $(\".pmv__select-page-open-list\").removeClass('active');\r\n                }\r\n            });\r\n            $(\"body\").on(\"pmv.user.changepage\", function(){\r\n                session.changePage(pageManagerVisualizator.currentPage);\r\n            });\r\n            $(\"body\").on(\"synchro.changed_page\", function(e, page){\r\n                $(\".pmv__pages-btn-page\").removeClass(\"active\");\r\n                $(\".pmv__pages-item[data-name='\"+page+\"'] > * > .pmv__pages-btn-page\").addClass(\"active\");\r\n                session.selectPage(page);\r\n            });\r\n\r\n            //Добавляем страницу\r\n            $('#modal-pmv-add-page-href .btn-select').on('click', function(event){\r\n                handlerAddPage( $('#modal-pmv-add-page-href .pmv-href').val() );\r\n                $('#modal-pmv-add-page-href .modal').modal('hide');\r\n            });\r\n            $('.pmv__add-page').on('click', function(){\r\n                if(pageManagerVisualizator._options.nameIFrame in window) {\r\n                    //отделить домен от urn\r\n                    $('#modal-pmv-add-page-href .pmv-href').val( window[pageManagerVisualizator._options.nameIFrame].window.location.href );\r\n                }\r\n                $('#modal-pmv-add-page-href .modal').modal('show');\r\n            });\r\n            $('#modal-pmv-add-page-href').on('shown.bs.modal', function(e){\r\n                var input = $('#modal-pmv-add-page-href .pmv-href');\r\n                //Выделение\r\n                input.get(0).focus();\r\n                //input.get(0).setSelectionRange(0, input.val().length);\r\n            });\r\n            function handlerAddPage(urn){\r\n                //pageManagerVisualizator.addPage( href );\r\n                console.log(urn);\r\n            }\r\n\r\n            //Удаляем страницу\r\n            $('.shab__top-menu .select-page.selectpicker').on('selectpicker.refresh', function(){//Чтоб при клике на крестике не переключалась страница\r\n                $('.shab__top-menu .select-page .delete').on('click', function(e){\r\n                    e.stopPropagation();\r\n                    if( confirm( \"Точно удалить!\" ) ) {\r\n                        pageManagerVisualizator.removePage( $(this).attr('data-href') );\r\n                    }\r\n                    return false;\r\n                });\r\n            });\r\n\r\n            //Обновляем страницу\r\n            $('.pmv__update-iframe-btn').on('click', pageManagerVisualizator.reloadPage);\r\n\r\n            //Обновляем список страниц в верхнем меню\r\n            pageManagerVisualizator.$container.on(\"pmv.change.pagelist\", refreshMenuView);\r\n            refreshMenuView();\r\n            \r\n            function refreshMenuView() {\r\n                var localSession = session.getLocalSessionParams();\r\n                dragItemList = false;\r\n                var $main = $(\".pmv__pages-sortable\");\r\n                $main.empty();\r\n\r\n                var res = (function recursion(el, html) {\r\n                    html += \"<ul>\";\r\n\r\n                    //li\r\n                    for(var i in el) {\r\n                        var name = (el[i].type == \"page\") ? el[i].urn : el[i].name;\r\n                        var _class = (el[i].type == \"page\")?\"page\":\"group btn-yellow\";\r\n                        var active = (el[i].type == \"page\" && localSession && \"pages\" in localSession && localSession.pages.currentPage === name)?\"active\":\"\";\r\n                        html += \"<li class='pmv__pages-item \"+((\"collapsed\" in el[i] && el[i].collapsed)?\"collapsed\":\"\")+\"' data-type='\"+(el[i].type)+\"' data-name='\"+name+\"'>\";\r\n                        html += '<div class=\"pmv__pages-item-content\">' +\r\n                            '<button class=\"btn btn-default btn-xs pmv__pages-btn-collapsed\"><span class=\"glyphicon glyphicon-minus\"></span><span class=\"glyphicon glyphicon-plus\"></span></button>' +\r\n                            '<button class=\"btn btn-default btn-xs btn-block pmv__pages-btn-'+_class+' '+active+'\">'+name+'</button>' +\r\n                            '<div class=\"btn btn-default btn-xs pmv__pages-btn-drag\"><span class=\"glyphicon glyphicon-move\"></span></div>' +\r\n                            '</div>';\r\n\r\n                        //sub\r\n                        if(\"sub\" in el[i]) {\r\n                            html = recursion(el[i].sub, html);\r\n                        }\r\n                        //sub (end)\r\n\r\n                        html += \"</li>\";\r\n\r\n                    }\r\n                    //li (end)\r\n\r\n                    return html += \"</ul>\";\r\n                })(session.globalSession.pages, \"\", 0);\r\n\r\n                $main.append(res);\r\n                $main.find(\" > ul\").nestedSortable({\r\n                    forcePlaceholderSize: true,\r\n                    handle: 'div',\r\n                    items: 'li',\r\n                    placeholder: 'placeholder',\r\n                    revert: 250,\r\n                    tabSize: 25,\r\n                    toleranceElement: '> div',\r\n                    listType: \"ul\",\r\n                    helper:\t'clone',\r\n                    maxLevels: 3,\r\n                    isTree: true,\r\n                    start: function () {\r\n                        dragItemList = true;\r\n                    },\r\n                    stop: function () {\r\n                        dragItemList = false;\r\n                    },\r\n                    update: function( event, ui ) {\r\n                        clearEmptyUl($main);\r\n                        refreshNestedEl($main);\r\n                        clearCollapseNotNested($main);\r\n                        session.data.pages = pagesNestedToJson($main);\r\n                        session.savePages();\r\n                    }\r\n                });\r\n                refreshNestedEl($main);\r\n                refreshCollapsed($main);\r\n            }\r\n\r\n            $(\".pmv__pages-sortable\").on(\"click\", \" .pmv__pages-btn-collapsed\", function(){\r\n                var $item = $(this).closest(\".pmv__pages-item\");\r\n                if( $item.hasClass(\"collapsed\") ) {\r\n                    $item.removeClass(\"collapsed\")\r\n                        .find(\" > ul\").css({display: \"block\"});\r\n                } else {\r\n                    $item.addClass(\"collapsed\")\r\n                        .find(\" > ul\").css({display: \"none\"});\r\n                }\r\n            });\r\n\r\n            //Парсинг страниц в json обьект\r\n            function pagesNestedToJson($main) {\r\n                var json = [], previousLevel = 0, stack = {\"0\":json};\r\n\r\n                $main.find(\".pmv__pages-item\").each(function() {\r\n                    var level = $(this).parents(\".pmv__pages-item\").length;\r\n                    if(level > previousLevel) {\r\n                        var obj = stack[previousLevel][stack[previousLevel].length-1];\r\n                        if(!(\"sub\" in obj)) {\r\n                            obj.sub = [];\r\n                            stack[level] = obj.sub;\r\n                        }\r\n                        stack[level].push(itemToJson($(this)));\r\n                    } else {\r\n                        stack[level].push(itemToJson($(this)));\r\n                    }\r\n                    previousLevel = level;\r\n                });\r\n\r\n                return json;\r\n            }\r\n\r\n                function itemToJson($item) {\r\n                    var obj = {};\r\n                    obj.type = $item.attr(\"data-type\");\r\n\r\n                    if($item.attr(\"data-type\") == \"page\") {\r\n                        obj.urn = $item.attr(\"data-name\");\r\n                    } else {\r\n                        obj.name = $item.attr(\"data-name\");\r\n                    }\r\n\r\n                    if($item.hasClass(\"collapsed\")) {\r\n                        obj.collapsed = true;\r\n                    }\r\n                    return obj;\r\n                }\r\n\r\n            //удаляем пустые тэги ul которые остаються после перестановки\r\n            function clearEmptyUl($main) {\r\n                $main.find(\" ul\").addClass(\"not-childrens\");\r\n                $main.find(\" ul > li\").each(function() {\r\n                    $(this).parent().removeClass(\"not-childrens\");\r\n                });\r\n                console.log($main.find(\" ul.not-childrens\").length);\r\n                $main.find(\" ul.not-childrens\").remove();\r\n            }\r\n\r\n            //очитстить от коллапсов\r\n            function clearCollapseNotNested($main) {\r\n                $main.find(\" .pmv__pages-item\").each(function() {\r\n                    if(!$(this).hasClass(\"have-nested\")) {\r\n                        $(this).removeClass(\"collapsed\");\r\n                    }\r\n                });\r\n            }\r\n\r\n            function refreshNestedEl($main) {\r\n                //Вставляем класс для вложенных\r\n                $main.find(\" .pmv__pages-item\").removeClass(\"have-nested\");\r\n                $main.find(\" ul\").each(function() {\r\n                    if($(this).parent(\".pmv__pages-item\").length) {\r\n                        $(this).parent(\".pmv__pages-item\").addClass(\"have-nested\");\r\n                    }\r\n                });\r\n            }\r\n            \r\n            function refreshCollapsed($main) {\r\n                //Коллапсируем рассколапсируем\r\n                $main.find(\" .pmv__pages-item.collapsed > ul\").css({display: \"none\"});\r\n                $main.find(\" .pmv__pages-item > ul\").not($main.find(\" .pmv__pages-item.collapsed > ul\")).css({display: \"block\"});\r\n            }\r\n\r\n            //При загрузке iFrame скрываем всё окно шаблонизатора и показываем анимацию загрузки\r\n            pageManagerVisualizator.$container.on({\r\n                \"pmv.prepaste.iframe\": function() {\r\n                    $( \"#loading\" )\r\n                        .css({width: \"100%\", height: \"100%\"})\r\n                        .addClass( \"show\" );\r\n                },\r\n                \"pmv.load.iframe\": function() {\r\n                    $( \"#loading\" ).removeClass( \"show\" );\r\n                    setTimeout(function() {\r\n                        $( \"#loading\" ).css({width: \"0\", height: \"0\"});\r\n                    }, 500);\r\n                }\r\n            });\r\n\r\n            pageManagerVisualizator._create();\r\n        })();\r\n\r\n        /****************************************************/\r\n        /*Пиксель перфект*/\r\n        /****************************************************/\r\n        /*(function() {\r\n            pixelPerfect = new modules.pixelPerfect($(\"#wrap_iframe .pmv-fitting-wrap\"), {\r\n                urlXML: \"sb/pixel-perfect.xml\",\r\n                dirScrins: \"design\",\r\n                dirThumbnail: \"sb/design-thumbnails\",\r\n                widthThumbnail: 240,\r\n                nameIFrame: \"PP_iframe\",\r\n                $screenshotsManipulatorContainer: $('.shab-general-window__bottom'),\r\n                thumbnailScrollAmount: 100,\r\n                mainWindowScrollAmount: 100\r\n            });\r\n\r\n            pageManagerVisualizator.$container.on( \"pmv.load.iframe\", function(){\r\n                pixelPerfect._destroy();\r\n                pixelPerfect._create( pageManagerVisualizator.lastLoadPage );\r\n\r\n                if( \"$session\" in pixelPerfect ) {\r\n                    pixelPerfect.screenshotsManipulator.refresh( pixelPerfect.$session, pixelPerfect.$listAllScrins, pixelPerfect.currentPage );\r\n                    handlerRefreshSelectSize();\r\n                }\r\n            });\r\n\r\n            //Добавляем разрешение\r\n            $('#modal-pp-add-group .btn-select').on('click', function(event){\r\n                var hasError = false;\r\n\r\n                //Фильтрация ввода\r\n                if( !( /^[1-9]\\d{1,3}$/gim.test( $('#modal-pp-add-group .pp-width').val() ) ) ) {\r\n                    hasError = true;\r\n                    $('#modal-pp-add-group .pp-width').closest( \".input-group\" ).addClass( \"has-error\" );\r\n                } else {\r\n                    $('#modal-pp-add-group .pp-width').closest( \".input-group\" ).removeClass( \"has-error\" );\r\n                }\r\n                if( !(/^[1-9]\\d{1,3}$/gim.test( $('#modal-pp-add-group .pp-height').val() ) ) ) {\r\n                    hasError = true;\r\n                    $('#modal-pp-add-group .pp-height').closest( \".input-group\" ).addClass( \"has-error\" );\r\n                } else {\r\n                    $('#modal-pp-add-group .pp-height').closest( \".input-group\" ).removeClass( \"has-error\" );\r\n                }\r\n\r\n                if( hasError ) {\r\n                    $('#modal-pp-add-group .alert-input-error').css({display: \"block\"});\r\n                } else {\r\n                    $('#modal-pp-add-group .alert-input-error').css({display: \"none\"});\r\n                }\r\n\r\n                if( !hasError ) {\r\n                    pixelPerfect.addSize( $('#modal-pp-add-group .pp-width').val(), $('#modal-pp-add-group .pp-height').val() );\r\n                    $('#modal-pp-add-group .modal').modal('hide');\r\n                }\r\n            });\r\n            $('.shab__top-menu .add-group').on('click', function(){\r\n                $('#modal-pp-add-group .modal').modal('show');\r\n            });\r\n\r\n            //Удаляем разрешение\r\n            $('.shab__top-menu .select-group.selectpicker').on('selectpicker.refresh', function(){//Чтоб при клике на крестике не переключалась страница\r\n                $('.shab__top-menu .select-group .delete').on('click', function(e){\r\n                    e.stopPropagation();\r\n                    if( confirm( \"Точно удалить!\" ) ) {\r\n                        pixelPerfect.removeSize( $(this).attr( \"data-width\" ), $(this).attr( \"data-height\" ) );\r\n                    }\r\n                    return false;\r\n                });\r\n            });\r\n\r\n            //Сменяем разрешение\r\n            $('.shab__top-menu').on('change', ' .select-group', function() {\r\n                var $optionSelected = $('.shab__top-menu .select-group option:selected');\r\n                pixelPerfect.selectSize( $optionSelected.attr('data-width'), $optionSelected.attr('data-height') );\r\n            });\r\n\r\n            //Обновляем список разрешений в верхнем меню\r\n            $('.shab__top-menu .select-group.selectpicker').selectpicker();\r\n            pixelPerfect.$container.on(\"pp.change.sizelist pp.create.sizelist\", function(){\r\n                handlerRefreshSelectSize();\r\n            });\r\n            pixelPerfect.screenshotsManipulator.$container.on(\"sm.change_post_set_session\", function(){\r\n                handlerRefreshSelectSize();\r\n            });\r\n            function handlerRefreshSelectSize() {\r\n                var pageList = pageManagerVisualizator._options.pageList;\r\n                var $selectSize = $('.shab__top-menu .select-group.selectpicker');\r\n                $selectSize.empty();\r\n                pixelPerfect.$session.find( \"page[href='\"+( pageManagerVisualizator.lastLoadPage )+\"'] media[width][height]\" ).each(function(){\r\n                    if( $(this).attr( \"active\" ) == \"true\" ) {\r\n                        $selectSize.append('<option selected=\"selected\" data-width=\"'+( $(this).attr( \"width\" ) )+'\" data-height=\"'+( $(this).attr( \"height\" ) )+'\" data-content=\"<span data-width=\\''+( $(this).attr( \"width\" ) )+'\\' data-height=\\''+( $(this).attr( \"height\" ) )+'\\' class=\\'delete glyphicon glyphicon-remove\\'></span>&nbsp;&nbsp;<span>'+( $(this).attr( \"width\" ) + \"x\" + $(this).attr( \"height\" ) )+'</span>\"></option>');\r\n                    } else {\r\n                        $selectSize.append('<option data-width=\"'+( $(this).attr( \"width\" ) )+'\" data-height=\"'+( $(this).attr( \"height\" ) )+'\" data-content=\"<span data-width=\\''+( $(this).attr( \"width\" ) )+'\\' data-height=\\''+( $(this).attr( \"height\" ) )+'\\' class=\\'delete glyphicon glyphicon-remove\\'></span>&nbsp;&nbsp;<span>'+( $(this).attr( \"width\" ) + \"x\" + $(this).attr( \"height\" ) )+'</span>\"></option>');\r\n                    }\r\n                });\r\n                $selectSize.selectpicker( \"refresh\" );\r\n                $selectSize.trigger( \"selectpicker.refresh\" );\r\n            }\r\n            //Показать \"манипулятор скриншотов\"\r\n            $('.pp__open-btn').on('click', function(){\r\n                pixelPerfect.screenshotsManipulator.toggle( pixelPerfect.$session );\r\n            });\r\n\r\n            //Обновить кнопку\r\n            pixelPerfect.screenshotsManipulator.$container.on({\r\n                \"sm.show\": function(){\r\n                    $('.pp__open-btn').addClass( \"active\" );\r\n                },\r\n                \"sm.hide\": function(){\r\n                    $('.pp__open-btn').removeClass( \"active\" );\r\n                }\r\n            });\r\n\r\n            //Показать верстку или скрины или 50 на 50\r\n            $('.pp__verstka-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(0);\r\n            });\r\n            $('.pp__50p-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(1);\r\n            });\r\n            $('.pp__design-btn').on('click', function(){\r\n                pixelPerfect.showPageProofsOrDesign(2);\r\n            });\r\n\r\n            //Горячие клавишы\r\n            pageManagerVisualizator.$container.on( \"pmv.load.iframe\", function(){\r\n                $('body')\r\n                    .add( $('#'+(pageManagerVisualizator._options.nameIFrame)).contents().find(\"body\") )\r\n                    .on('keydown', function(e) {\r\n                        if(e.which == 81 && e.ctrlKey && !e.shiftKey && !e.altKey)//(e.which == 65 || e.which == 83 || e.which == 68)\r\n                        {\r\n                            if($('.pp__50p-btn, .pp__design-btn').hasClass('active'))\r\n                            {\r\n                                pixelPerfect.showPageProofsOrDesign(0);\r\n                            }\r\n                            else\r\n                            {\r\n                                pixelPerfect.showPageProofsOrDesign(1);\r\n                            }\r\n\r\n                            e = e || window.e; if (e.stopPropagation) {e.stopPropagation()} else {e.cancelBubble = true} e.preventDefault();\r\n                        }\r\n                    });\r\n            });\r\n\r\n            //Обновить кнопки\r\n            pixelPerfect.$container.on(\"pp.changepageproofsordesign\", function(e, show){\r\n                $('.pp-verstka-design .btn').removeClass( \"active btn-primary btn-success btn-info btn-warning btn-danger\" ).addClass( \"btn-default\" );\r\n                switch( show ){\r\n                    case 0:\r\n                        $('.pp__verstka-btn').removeClass( \"btn-default\" ).addClass( \"active btn-primary\" );\r\n                        break;\r\n                    case 1:\r\n                        $('.pp__50p-btn').removeClass( \"btn-default\" ).addClass( \"active btn-warning\" );\r\n                        break;\r\n                    case 2:\r\n                        $('.pp__design-btn').removeClass( \"btn-default\" ).addClass( \"active btn-danger\" );\r\n                        break;\r\n                }\r\n            });\r\n        })();*/\r\n\r\n        /****************************************************/\r\n        /*Для тестов*/\r\n        /****************************************************/\r\n        $(document).ready(function(){\r\n            $('#testovaya_ssilka').on('click', function(event){\r\n\r\n            });\r\n        });\r\n\r\n        /****************************************************/\r\n        /*Вспомогательная хрень*/\r\n        /****************************************************/\r\n        $(document).ready(function(){\r\n            //Подсказки\r\n            $('[data-toggle=\"tooltip\"]').tooltip();\r\n            $('[data-toggle=\"popover\"]').popover();\r\n            //==========\r\n        });\r\n    }\r\n});\r\n\r\n"]}