jQuery(function(e){function a(){!function(){function a(){"openOptionsTimeLine__close"in t&&t.openOptionsTimeLine__close.pause(),e(" .shab__global-settings").css({display:"block",opacity:0,transform:"scale(0.8, 0.8)"}),"openOptionsTimeLine"in t?t.openOptionsTimeLine.restart():t.openOptionsTimeLine=(new TimelineLite).append([TweenMax.to(e(".shab__global-settings"),.5,{css:{transform:"scale(1, 1)"}}),TweenMax.to(e(".shab__global-settings"),.3,{css:{opacity:1}})]),e(".shab__global-settings-btn").addClass("active")}function n(){function a(){e(".shab__global-settings").css("display","none")}"openOptionsTimeLine"in t&&t.openOptionsTimeLine.pause(),"openOptionsTimeLine__close"in t?t.openOptionsTimeLine__close.restart():t.openOptionsTimeLine__close=(new TimelineLite).append([TweenMax.to(e(".shab__global-settings"),.5,{css:{transform:"scale(0.8, 0.8)"},onComplete:a}),TweenMax.to(e(".shab__global-settings"),.5,{css:{opacity:0}})]),e(".shab__global-settings-btn").removeClass("active")}var t={};e(".shab__global-settings-btn").on("click",function(){e(this).hasClass("active")?n():a()}),e("body").on("click click.body.iframe",function(a){0==e(a.target).closest(e(".shab__global-settings-btn").add(e(".shab__global-settings"))).size()&&e(".shab__global-settings-btn").hasClass("active")&&n()})}(),function(){function a(e){pageManagerVisualizator.addPage(e)}function s(){d=!1;var a=e(".pmv__pages-sortable");a.empty();var s=function e(a,n){n+="<ul>";for(var t in a){var s="page"==a[t].type?a[t].urn:a[t].name,o="page"==a[t].type?"page":"group";n+="<li class='pmv__pages-item "+("collapsed"in a[t]&&a[t].collapsed?"collapsed":"")+"' data-type='"+a[t].type+"' data-name='"+s+"'>",n+='<div class="pmv__pages-item-content"><button class="btn btn-default btn-xs pmv__pages-btn-collapsed"><span class="glyphicon glyphicon-minus"></span><span class="glyphicon glyphicon-plus"></span></button><button class="btn btn-default btn-xs btn-block pmv__pages-btn-'+o+'">'+s+'</button><div class="btn btn-default btn-xs pmv__pages-btn-drag"><span class="glyphicon glyphicon-move"></span></div></div>',"sub"in a[t]&&(n=e(a[t].sub,n)),n+="</li>"}return n+="</ul>"}(n.data.pages,"",0);a.append(s),a.find(" > ul").nestedSortable({forcePlaceholderSize:!0,handle:"div",items:"li",placeholder:"placeholder",revert:250,tabSize:25,toleranceElement:"> div",listType:"ul",helper:"clone",maxLevels:3,isTree:!0,start:function(){d=!0},stop:function(){d=!1},update:function(e,s){l(a),c(a),p(a),t.emit("changepages",{gg:3}),n.data.pages=o(a),n.save()}}),c(a),r(a)}function o(a){var n=[],t=0,s={0:n};return a.find(".pmv__pages-item").each(function(){var a=e(this).parents(".pmv__pages-item").length;if(a>t){var n=s[t][s[t].length-1];"sub"in n||(n.sub=[],s[a]=n.sub),s[a].push(i(e(this)))}else s[a].push(i(e(this)));t=a}),n}function i(e){var a={};return a.type=e.attr("data-type"),"page"==e.attr("data-type")?a.urn=e.attr("data-name"):a.name=e.attr("data-name"),e.hasClass("collapsed")&&(a.collapsed=!0),a}function l(a){a.find(" ul").addClass("not-childrens"),a.find(" ul > li").each(function(){e(this).parent().removeClass("not-childrens")}),console.log(a.find(" ul.not-childrens").length),a.find(" ul.not-childrens").remove()}function p(a){a.find(" .pmv__pages-item").each(function(){e(this).hasClass("have-nested")||e(this).removeClass("collapsed")})}function c(a){a.find(" .pmv__pages-item").removeClass("have-nested"),a.find(" ul").each(function(){e(this).parent(".pmv__pages-item").length&&e(this).parent(".pmv__pages-item").addClass("have-nested")})}function r(e){e.find(" .pmv__pages-item.collapsed > ul").css({display:"none"}),e.find(" .pmv__pages-item > ul").not(e.find(" .pmv__pages-item.collapsed > ul")).css({display:"block"})}pageManagerVisualizator=new modules.pageManagerVisualizator(e("#wrap_iframe"),n,{$mapNavigatorContainer:e(".shab__main-menu-container"),nameIFrame:"PP_iframe",pixelsScrollableInSeconds:2e3,minWOuterScroll:23,minHOuterScroll:23,minWDraggable:15,minHDraggable:15,minWIFrame:320,minHIFrame:480,responsiveToMovementOfTheCursorInAConfinedSpace:!1,gorizontalFixation:"center",verticalFixation:"top"}),e(".pmv__pages-sortable-scrollwrap").mCustomScrollbar({axis:"y",theme:"dark",scrollbarPosition:"outside",scrollInertia:100,mouseWheel:{scrollAmount:100},callbacks:{onUpdate:function(){console.log("onUpdate")}}}),e(".pmv__select-page-open-list").on("click",function(){e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active")});var d=!1;e("body").on("click click.body.iframe",function(a){0!=e(a.target).closest(e(".pmv__select-page-open-list").add(e(".pmv__pages-window"))).length||d||e(".pmv__select-page-open-list").hasClass("active")&&e(".pmv__select-page-open-list").removeClass("active")}),e("#modal-pp-add-page-href .btn-select").on("click",function(n){a(e("#modal-pp-add-page-href .pmv-href").val()),e("#modal-pp-add-page-href .modal").modal("hide")}),e(".pmv__add-page").on("click",function(){e("#modal-pp-add-page-href .pmv-href").val(window[pageManagerVisualizator._options.nameIFrame].window.location.href),e("#modal-pp-add-page-href .modal").modal("show")}),e("#modal-pp-add-page-href").on("shown.bs.modal",function(a){var n=e("#modal-pp-add-page-href .pmv-href");n.get(0).focus(),n.get(0).setSelectionRange(0,n.val().length)}),e(".shab__top-menu .select-page.selectpicker").on("selectpicker.refresh",function(){e(".shab__top-menu .select-page .delete").on("click",function(a){return a.stopPropagation(),confirm("Точно удалить!")&&pageManagerVisualizator.removePage(e(this).attr("data-href")),!1})}),e(".shab__top-menu").on("change"," .select-page.selectpicker",function(){pageManagerVisualizator.selectPage(e(".shab__top-menu .select-page option:selected").first().attr("data-href"))}),e(".pmv__update-iframe-btn").on("click",pageManagerVisualizator.reloadPage),pageManagerVisualizator.$container.on("pmv.change.pagelist",s),s(),e(".pmv__pages-sortable").on("click"," .pmv__pages-btn-collapsed",function(){var a=e(this).closest(".pmv__pages-item");a.hasClass("collapsed")?a.removeClass("collapsed").find(" > ul").css({display:"block"}):a.addClass("collapsed").find(" > ul").css({display:"none"})}),pageManagerVisualizator.$container.on({"pmv.prepaste.iframe":function(){e("#loading").css({width:"100%",height:"100%"}).addClass("show")},"pmv.load.iframe":function(){e("#loading").removeClass("show"),setTimeout(function(){e("#loading").css({width:"0",height:"0"})},500)}}),pageManagerVisualizator._create()}(),e(document).ready(function(){e("#testovaya_ssilka").on("click",function(e){})}),e(document).ready(function(){pageManagerVisualizator.$container.on("pmv.load.iframe",function(){shablonizator.updateBasesUrlPage(pageManagerVisualizator.lastLoadPage)}),e('[data-toggle="tooltip"]').tooltip(),e('[data-toggle="popover"]').popover()})}e("body").on("keydown",function(e){49==e.which&&e.altKey&&(e=e||window.e,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault())});var n,t=io.connect("/");t.once("session.load",function(e){n=new modules.sessionModel(e,t),a()})});
//# sourceMappingURL=main.js.map
