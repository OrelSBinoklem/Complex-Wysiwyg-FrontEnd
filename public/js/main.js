jQuery(function(e){function a(){!function(){function a(){"openOptionsTimeLine__close"in s&&s.openOptionsTimeLine__close.pause(),e(" .shab__global-settings").css({display:"block",opacity:0,transform:"scale(0.8, 0.8)"}),"openOptionsTimeLine"in s?s.openOptionsTimeLine.restart():s.openOptionsTimeLine=(new TimelineLite).append([TweenMax.to(e(".shab__global-settings"),.5,{css:{transform:"scale(1, 1)"}}),TweenMax.to(e(".shab__global-settings"),.3,{css:{opacity:1}})]),e(".shab__global-settings-btn").addClass("active")}function n(){function a(){e(".shab__global-settings").css("display","none")}"openOptionsTimeLine"in s&&s.openOptionsTimeLine.pause(),"openOptionsTimeLine__close"in s?s.openOptionsTimeLine__close.restart():s.openOptionsTimeLine__close=(new TimelineLite).append([TweenMax.to(e(".shab__global-settings"),.5,{css:{transform:"scale(0.8, 0.8)"},onComplete:a}),TweenMax.to(e(".shab__global-settings"),.5,{css:{opacity:0}})]),e(".shab__global-settings-btn").removeClass("active")}var s={};e(".shab__global-settings-btn").on("click",function(){e(this).hasClass("active")?n():a()}),e("body").on("click click.body.iframe",function(a){0==e(a.target).closest(e(".shab__global-settings-btn").add(e(".shab__global-settings"))).size()&&e(".shab__global-settings-btn").hasClass("active")&&n()})}(),function(){function a(e){console.log(e)}function s(){r=!1;var a=e(".pmv__pages-sortable");a.empty();var s=function e(a,n){n+="<ul>";for(var s in a){var t="page"==a[s].type?a[s].urn:a[s].name,o="page"==a[s].type?"page":"group";n+="<li class='pmv__pages-item "+("collapsed"in a[s]&&a[s].collapsed?"collapsed":"")+"' data-type='"+a[s].type+"' data-name='"+t+"'>",n+='<div class="pmv__pages-item-content"><button class="btn btn-default btn-xs pmv__pages-btn-collapsed"><span class="glyphicon glyphicon-minus"></span><span class="glyphicon glyphicon-plus"></span></button><button class="btn btn-default btn-xs btn-block pmv__pages-btn-'+o+'">'+t+'</button><div class="btn btn-default btn-xs pmv__pages-btn-drag"><span class="glyphicon glyphicon-move"></span></div></div>',"sub"in a[s]&&(n=e(a[s].sub,n)),n+="</li>"}return n+="</ul>"}(n.data.pages,"",0);a.append(s),a.find(" > ul").nestedSortable({forcePlaceholderSize:!0,handle:"div",items:"li",placeholder:"placeholder",revert:250,tabSize:25,toleranceElement:"> div",listType:"ul",helper:"clone",maxLevels:3,isTree:!0,start:function(){r=!0},stop:function(){r=!1},update:function(e,s){i(a),p(a),l(a),n.data.pages=t(a),n.savePages()}}),p(a),c(a)}function t(a){var n=[],s=0,t={0:n};return a.find(".pmv__pages-item").each(function(){var a=e(this).parents(".pmv__pages-item").length;if(a>s){var n=t[s][t[s].length-1];"sub"in n||(n.sub=[],t[a]=n.sub),t[a].push(o(e(this)))}else t[a].push(o(e(this)));s=a}),n}function o(e){var a={};return a.type=e.attr("data-type"),"page"==e.attr("data-type")?a.urn=e.attr("data-name"):a.name=e.attr("data-name"),e.hasClass("collapsed")&&(a.collapsed=!0),a}function i(a){a.find(" ul").addClass("not-childrens"),a.find(" ul > li").each(function(){e(this).parent().removeClass("not-childrens")}),console.log(a.find(" ul.not-childrens").length),a.find(" ul.not-childrens").remove()}function l(a){a.find(" .pmv__pages-item").each(function(){e(this).hasClass("have-nested")||e(this).removeClass("collapsed")})}function p(a){a.find(" .pmv__pages-item").removeClass("have-nested"),a.find(" ul").each(function(){e(this).parent(".pmv__pages-item").length&&e(this).parent(".pmv__pages-item").addClass("have-nested")})}function c(e){e.find(" .pmv__pages-item.collapsed > ul").css({display:"none"}),e.find(" .pmv__pages-item > ul").not(e.find(" .pmv__pages-item.collapsed > ul")).css({display:"block"})}pageManagerVisualizator=new modules.pageManagerVisualizator(e("#wrap_iframe"),n,{$mapNavigatorContainer:e(".shab__main-menu-container"),nameIFrame:"PP_iframe",pixelsScrollableInSeconds:2e3,minWOuterScroll:23,minHOuterScroll:23,minWDraggable:15,minHDraggable:15,minWIFrame:320,minHIFrame:480,responsiveToMovementOfTheCursorInAConfinedSpace:!1,gorizontalFixation:"center",verticalFixation:"top"}),e(".pmv__pages-sortable-scrollwrap").mCustomScrollbar({axis:"y",theme:"dark",scrollbarPosition:"outside",scrollInertia:100,mouseWheel:{scrollAmount:100},callbacks:{onUpdate:function(){e(".pmv__pages-sortable-scrollwrap").hasClass("_mCS_1 mCS_no_scrollbar")?e(".pmv__pages-window").addClass("no-scrollbar"):e(".pmv__pages-window").removeClass("no-scrollbar")}}}),e(".pmv__select-page-open-list").on("click",function(){e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active")});var r=!1;e("body").on("click click.body.iframe",function(a){0!=e(a.target).closest(e(".pmv__select-page-open-list").add(e(".pmv__pages-window")).add(e("#modal-pmv-add-page-href"))).length||r||e(".pmv__select-page-open-list").hasClass("active")&&e(".pmv__select-page-open-list").removeClass("active")}),e("#modal-pmv-add-page-href .btn-select").on("click",function(n){a(e("#modal-pmv-add-page-href .pmv-href").val()),e("#modal-pmv-add-page-href .modal").modal("hide")}),e(".pmv__add-page").on("click",function(){pageManagerVisualizator._options.nameIFrame in window&&e("#modal-pmv-add-page-href .pmv-href").val(window[pageManagerVisualizator._options.nameIFrame].window.location.href),e("#modal-pmv-add-page-href .modal").modal("show")}),e("#modal-pmv-add-page-href").on("shown.bs.modal",function(a){var n=e("#modal-pmv-add-page-href .pmv-href");n.get(0).focus()}),e(".shab__top-menu .select-page.selectpicker").on("selectpicker.refresh",function(){e(".shab__top-menu .select-page .delete").on("click",function(a){return a.stopPropagation(),confirm("Точно удалить!")&&pageManagerVisualizator.removePage(e(this).attr("data-href")),!1})}),e(".shab__top-menu").on("change"," .select-page.selectpicker",function(){pageManagerVisualizator.selectPage(e(".shab__top-menu .select-page option:selected").first().attr("data-href"))}),e(".pmv__update-iframe-btn").on("click",pageManagerVisualizator.reloadPage),pageManagerVisualizator.$container.on("pmv.change.pagelist",s),s(),e(".pmv__pages-sortable").on("click"," .pmv__pages-btn-collapsed",function(){var a=e(this).closest(".pmv__pages-item");a.hasClass("collapsed")?a.removeClass("collapsed").find(" > ul").css({display:"block"}):a.addClass("collapsed").find(" > ul").css({display:"none"})}),pageManagerVisualizator.$container.on({"pmv.prepaste.iframe":function(){e("#loading").css({width:"100%",height:"100%"}).addClass("show")},"pmv.load.iframe":function(){e("#loading").removeClass("show"),setTimeout(function(){e("#loading").css({width:"0",height:"0"})},500)}}),pageManagerVisualizator._create()}(),e(document).ready(function(){e("#testovaya_ssilka").on("click",function(e){})}),e(document).ready(function(){pageManagerVisualizator.$container.on("pmv.load.iframe",function(){shablonizator.updateBasesUrlPage(pageManagerVisualizator.lastLoadPage)}),e('[data-toggle="tooltip"]').tooltip(),e('[data-toggle="popover"]').popover()})}e("body").on("keydown",function(e){49==e.which&&e.altKey&&(e=e||window.e,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault())});var n,s=io.connect("/");s.once("session.load",function(e){n=new modules.sessionModel(e,s),a()})});
//# sourceMappingURL=main.js.map
