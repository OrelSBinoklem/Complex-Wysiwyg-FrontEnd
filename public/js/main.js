jQuery(function(s){function e(){!function(){function e(){"openOptionsTimeLine__close"in n&&n.openOptionsTimeLine__close.pause(),s(" .shab__global-settings").css({display:"block",opacity:0,transform:"scale(0.8, 0.8)"}),"openOptionsTimeLine"in n?n.openOptionsTimeLine.restart():n.openOptionsTimeLine=(new TimelineLite).append([TweenMax.to(s(".shab__global-settings"),.5,{css:{transform:"scale(1, 1)"}}),TweenMax.to(s(".shab__global-settings"),.3,{css:{opacity:1}})]),s(".shab__global-settings-btn").addClass("active")}function a(){function e(){s(".shab__global-settings").css("display","none")}"openOptionsTimeLine"in n&&n.openOptionsTimeLine.pause(),"openOptionsTimeLine__close"in n?n.openOptionsTimeLine__close.restart():n.openOptionsTimeLine__close=(new TimelineLite).append([TweenMax.to(s(".shab__global-settings"),.5,{css:{transform:"scale(0.8, 0.8)"},onComplete:e}),TweenMax.to(s(".shab__global-settings"),.5,{css:{opacity:0}})]),s(".shab__global-settings-btn").removeClass("active")}var n={};s(".shab__global-settings-btn").on("click",function(){s(this).hasClass("active")?a():e()}),s("body").on("click click.body.iframe",function(e){0==s(e.target).closest(s(".shab__global-settings-btn").add(s(".shab__global-settings"))).size()&&s(".shab__global-settings-btn").hasClass("active")&&a()})}(),function(){function e(){if(a.sessionGroupSynchronizations.length){var e,n=void 0!==s.cookie("adaptive_pixel_perfect_groups_session");if(n){e=s.secureEvalJSON(s.cookie("adaptive_pixel_perfect_groups_session")).groups;var o={};for(var t in a.sessionGroupSynchronizations){var i=a.sessionGroupSynchronizations[t];o[i.name]=i}e.filter(function(s,e,a){return s in o}),s.cookie("adaptive_pixel_perfect_groups_session",s.toJSON({groups:e})),e.length||(s.removeCookie("adaptive_pixel_perfect_groups_session"),n=!1,e=[])}var l={};for(var p in e)l[e[p]]=!0;var r="";for(var t in a.sessionGroupSynchronizations){var c=a.sessionGroupSynchronizations[t],d={};for(var p in c.synchroParams)d[c.synchroParams[p]]=!0;var u=n&&c.name in l?"active":"";r+='<li class="shab__session-groups-list-item '+u+'" data-name="'+c.name+'"><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn '+("pages"in d?"active":"")+'" data-param="pages"><i class="fa fa-file-o"></i></button><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn '+("resolutions"in d?"active":"")+'" data-param="resolutions"><i class="fa fa-arrows"></i></button><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn '+("iframe"in d?"active":"")+'" data-param="iframe"><i class="fa fa-desktop"></i></button><button class="btn btn-default btn-xs btn-block shab__session-groups-list-btn '+u+'">'+c.name+'</button><div class="btn btn-default btn-xs shab__session-groups-btn-drag"><span class="glyphicon glyphicon-move"></span></div><button class="btn btn-default btn-xs shab__session-groups-delete-btn"><span class="glyphicon glyphicon-remove"></span></button></li>'}s(".shab__session-groups-list-ul").empty().append(r)}else void 0!==s.cookie("adaptive_pixel_perfect_groups_session")&&s.removeCookie("adaptive_pixel_perfect_groups_session")}function n(e){var n=[];e.find(" .shab__session-groups-list-ul > li").each(function(){var e=[];s(this).find(" .shab__session-groups-synchro-params-btn.active").each(function(){e.push(s(this).attr("data-param"))}),n.push({name:s(this).attr("data-name"),synchroParams:e})}),a.menuJsonToGroupsSessionJson(n)}s(".shab__btn-open-groups-session").on("click",function(){s(this).hasClass("active")?(s(this).removeClass("active"),s(".shab__session-groups-list").removeClass("open")):(s(this).addClass("active"),s(".shab__session-groups-list").addClass("open"))}),s("body").on("click click.body.iframe",function(e){0==s(e.target).closest(s(".shab__btn-open-groups-session").add(s(".shab__session-groups-list")).add(s("#shab-add-group-session")).add(s("#shab-delete-group-session"))).length&&(s(".shab__btn-open-groups-session").removeClass("active"),s(".shab__session-groups-list").removeClass("open"))}),s(".shab__session-groups-list").prepend("<ul class='shab__session-groups-list-ul'></ul>"),e(),s(".shab__session-groups-list-ul").sortable({axis:"y",items:"> li",update:function(){s(".shab__session-groups-list").trigger("shab.user.change_session_group")}}).disableSelection(),s(".shab__add-group-session").on("click",function(){s("#shab-add-group-session .modal").modal("show")}),s("#shab-add-group-session .btn-select").on("click",function(){var e=s("#shab-add-group-session .shab-add-group-session__name").val();if(s.trim(e)){var a='<li class="shab__session-groups-list-item" data-name="'+s.trim(e)+'"><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn" data-param="pages"><i class="fa fa-file-o"></i></button><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn" data-param="resolutions"><i class="fa fa-arrows"></i></button><button class="btn btn-default btn-xs shab__session-groups-synchro-params-btn" data-param="iframe"><i class="fa fa-desktop"></i></button><button class="btn btn-default btn-xs btn-block shab__session-groups-list-btn">'+s.trim(e)+'</button><div class="btn btn-default btn-xs shab__session-groups-btn-drag"><span class="glyphicon glyphicon-move"></span></div><button class="btn btn-default btn-xs shab__session-groups-delete-btn"><span class="glyphicon glyphicon-remove"></span></button></li>';s(".shab__session-groups-list-ul").append(a),s(".shab__session-groups-list").trigger("shab.user.change_session_group")}else alert("Имя недолжно быть пустым");s("#shab-add-group-session .modal").modal("hide")}),s(".shab__session-groups-list").on("click"," .shab__session-groups-delete-btn",function(){s("#shab-delete-group-session .modal").modal("show");var e=s(this).closest(".shab__session-groups-list-item").attr("data-name");s("#shab-delete-group-session .shab-delete-group-session__name").attr("data-name",e).text(e)}),s("#shab-delete-group-session .btn-select").on("click",function(){var e=s("#shab-delete-group-session .shab-delete-group-session__name").attr("data-name");s(".shab__session-groups-list-item[data-name='"+e+"']").remove(),s(".shab__session-groups-list").trigger("shab.user.change_session_group"),s("#shab-delete-group-session .modal").modal("hide")}),s(".shab__session-groups-list").on("click"," .shab__session-groups-list-btn",function(){s(".shab__session-groups-list.open").length&&(s(this).hasClass("active")?s(this).removeClass("active").closest(".shab__session-groups-list-item").removeClass("active"):s(this).addClass("active").closest(".shab__session-groups-list-item").addClass("active"))}),s(".shab__session-groups-list").on("click"," .shab__session-groups-synchro-params-btn",function(){s(this).hasClass("active")?s(this).removeClass("active"):s(this).addClass("active"),s(".shab__session-groups-list").trigger("shab.user.change_session_group")}),s("body").on("shab.user.change_session_group",function(){n(),a.modifiedSessionGroupList()})}(),function(){function e(s){console.log(s)}function n(){var e=a.getLocalSessionParams();c=!1;var n=s(".pmv__pages-sortable");n.empty();var t=function s(a,n){n+="<ul>";for(var o in a){var t="page"==a[o].type?a[o].urn:a[o].name,i="page"==a[o].type?"page":"group btn-yellow",l="page"==a[o].type&&e&&"pages"in e&&e.pages.currentPage===t?"active":"";n+="<li class='pmv__pages-item "+("collapsed"in a[o]&&a[o].collapsed?"collapsed":"")+"' data-type='"+a[o].type+"' data-name='"+t+"'>",n+='<div class="pmv__pages-item-content"><button class="btn btn-default btn-xs pmv__pages-btn-collapsed"><span class="glyphicon glyphicon-minus"></span><span class="glyphicon glyphicon-plus"></span></button><button class="btn btn-default btn-xs btn-block pmv__pages-btn-'+i+" "+l+'">'+t+'</button><div class="btn btn-default btn-xs pmv__pages-btn-drag"><span class="glyphicon glyphicon-move"></span></div></div>',"sub"in a[o]&&(n=s(a[o].sub,n)),n+="</li>"}return n+="</ul>"}(a.globalSession.pages,"",0);n.append(t),n.find(" > ul").nestedSortable({forcePlaceholderSize:!0,handle:"div",items:"li",placeholder:"placeholder",revert:250,tabSize:25,toleranceElement:"> div",listType:"ul",helper:"clone",maxLevels:3,isTree:!0,start:function(){c=!0},stop:function(){c=!1},update:function(s,e){i(n),p(n),l(n),a.data.pages=o(n),a.savePages()}}),p(n),r(n)}function o(e){var a=[],n=0,o={0:a};return e.find(".pmv__pages-item").each(function(){var e=s(this).parents(".pmv__pages-item").length;if(e>n){var a=o[n][o[n].length-1];"sub"in a||(a.sub=[],o[e]=a.sub),o[e].push(t(s(this)))}else o[e].push(t(s(this)));n=e}),a}function t(s){var e={};return e.type=s.attr("data-type"),"page"==s.attr("data-type")?e.urn=s.attr("data-name"):e.name=s.attr("data-name"),s.hasClass("collapsed")&&(e.collapsed=!0),e}function i(e){e.find(" ul").addClass("not-childrens"),e.find(" ul > li").each(function(){s(this).parent().removeClass("not-childrens")}),console.log(e.find(" ul.not-childrens").length),e.find(" ul.not-childrens").remove()}function l(e){e.find(" .pmv__pages-item").each(function(){s(this).hasClass("have-nested")||s(this).removeClass("collapsed")})}function p(e){e.find(" .pmv__pages-item").removeClass("have-nested"),e.find(" ul").each(function(){s(this).parent(".pmv__pages-item").length&&s(this).parent(".pmv__pages-item").addClass("have-nested")})}function r(s){s.find(" .pmv__pages-item.collapsed > ul").css({display:"none"}),s.find(" .pmv__pages-item > ul").not(s.find(" .pmv__pages-item.collapsed > ul")).css({display:"block"})}pageManagerVisualizator=new modules.pageManagerVisualizator(s("#wrap_iframe"),a,{$mapNavigatorContainer:s(".mnif__navigator-window"),nameIFrame:"PP_iframe",pixelsScrollableInSeconds:2e3,minWOuterScroll:23,minHOuterScroll:23,minWDraggable:15,minHDraggable:15,minWIFrame:320,minHIFrame:480,responsiveToMovementOfTheCursorInAConfinedSpace:!0,movementOfTheCursorInAConfinedSpaceSpred:10,gorizontalFixation:"center",verticalFixation:"top"}),s(".pmv__pages-sortable-scrollwrap").mCustomScrollbar({axis:"y",theme:"dark",scrollbarPosition:"outside",scrollInertia:100,mouseWheel:{scrollAmount:100},callbacks:{onUpdate:function(){s(".pmv__pages-sortable-scrollwrap").hasClass("_mCS_1 mCS_no_scrollbar")?s(".pmv__pages-window").addClass("no-scrollbar"):s(".pmv__pages-window").removeClass("no-scrollbar")}}}),s(".pmv__select-page-open-list").on("click",function(){s(this).toggleClass("active")});var c=!1;s("body").on("click click.body.iframe",function(e){0!=s(e.target).closest(s(".pmv__select-page-open-list").add(s(".pmv__pages-window")).add(s("#modal-pmv-add-page-href"))).length||c||s(".pmv__select-page-open-list").removeClass("active")}),s(".pmv__pages-sortable").on("click"," .pmv__pages-btn-page",function(){s(".pmv__pages-btn-page").removeClass("active"),s(this).addClass("active"),pageManagerVisualizator.handlerSelectPage(s(this).closest(".pmv__pages-item").attr("data-name")),s(".pmv__select-page-open-list").hasClass("active")&&s(".pmv__select-page-open-list").removeClass("active")}),s("body").on("pmv.user.changepage",function(){a.changePage(pageManagerVisualizator.currentPage)}),s("body").on("synchro.changed_page",function(e,n){s(".pmv__pages-btn-page").removeClass("active"),s(".pmv__pages-item[data-name='"+n+"'] > * > .pmv__pages-btn-page").addClass("active"),a.selectPage(n)}),s("#modal-pmv-add-page-href .btn-select").on("click",function(a){e(s("#modal-pmv-add-page-href .pmv-href").val()),s("#modal-pmv-add-page-href .modal").modal("hide")}),s(".pmv__add-page").on("click",function(){pageManagerVisualizator._options.nameIFrame in window&&s("#modal-pmv-add-page-href .pmv-href").val(window[pageManagerVisualizator._options.nameIFrame].window.location.href),s("#modal-pmv-add-page-href .modal").modal("show")}),s("#modal-pmv-add-page-href").on("shown.bs.modal",function(e){var a=s("#modal-pmv-add-page-href .pmv-href");a.get(0).focus()}),s(".shab__top-menu .select-page.selectpicker").on("selectpicker.refresh",function(){s(".shab__top-menu .select-page .delete").on("click",function(e){return e.stopPropagation(),confirm("Точно удалить!")&&pageManagerVisualizator.removePage(s(this).attr("data-href")),!1})}),s(".pmv__update-iframe-btn").on("click",pageManagerVisualizator.reloadPage),pageManagerVisualizator.$container.on("pmv.change.pagelist",n),n(),s(".pmv__pages-sortable").on("click"," .pmv__pages-btn-collapsed",function(){var e=s(this).closest(".pmv__pages-item");e.hasClass("collapsed")?e.removeClass("collapsed").find(" > ul").css({display:"block"}):e.addClass("collapsed").find(" > ul").css({display:"none"})}),pageManagerVisualizator.$container.on({"pmv.prepaste.iframe":function(){s("#loading").css({width:"100%",height:"100%"}).addClass("show")},"pmv.load.iframe":function(){s("#loading").removeClass("show"),setTimeout(function(){s("#loading").css({width:"0",height:"0"})},500)}}),pageManagerVisualizator._create()}(),s(document).ready(function(){s("#testovaya_ssilka").on("click",function(s){})}),s(document).ready(function(){s('[data-toggle="tooltip"]').tooltip(),s('[data-toggle="popover"]').popover()})}s("body").on("keydown",function(s){49==s.which&&s.altKey&&(s=s||window.e,s.stopPropagation?s.stopPropagation():s.cancelBubble=!0,s.preventDefault())});var a,n=io.connect("/");n.once("session.load",function(s){a=new modules.sessionModel(s,n),e()})});
//# sourceMappingURL=main.js.map
