!function(t){var i=function(i,e){this._options=e;var n=this;n.$container=i,this._create=function(e){i.append('<div class="sm-container-scroll-wrap"><ul class="sm-container"></ul></div>'),i.append('<div class="sm-thumbnail"><div class="sm-thumbnail-img-container"></div></div>'),i.find(" .sm-container-scroll-wrap").mCustomScrollbar({axis:"y",theme:"dark",scrollbarPosition:"outside",scrollInertia:100,mouseWheel:{scrollAmount:n._options.thumbnailScrollAmount}}),i.find(" .sm-thumbnail").mCustomScrollbar({axis:"y",theme:"dark",scrollbarPosition:"outside",scrollInertia:100,mouseWheel:{scrollAmount:n._options.thumbnailScrollAmount}}),t("body").on("click click.body.iframe",n.handlerClickBeyondLimits),i.on("click"," .btn-deviation",n.handlerOpenDeviation),i.on("click"," .sm-media .h-group",n.handlerClickMedia),i.on("click"," .sm-media .sm-scrin",n.handlerClickScrin),i.on("click"," .sm-deviation-fixed-or-static .btn",n.handlerChangeStaticOrFixed),i.on("click"," .sm-deviation-relative .btn",n.handlerChangeRelativePosition),i.on("mouseenter"," .sm-scrin",n._handlerShowThumbnail),i.on("mouseleave",n._handlerHideThumbnail)},this._destroy=function(){i.find(" .sm-container-scroll-wrap").remove()},this.handlerOpenDeviation=function(e){e.preventDefault(),"none"==t(this).find(" ~ .sm-deviation").css("display")?(i.find(" .sm-deviation").css({display:"none"}),t(this).find(" ~ .sm-deviation").css({display:"block"})):i.find(" .sm-deviation").css({display:"none"})},this.handlerCloseDeviation=function(e){0==t(e.target).closest(".btn-deviation, .sm-deviation").size()&&i.find(" .sm-deviation").css({display:"none"})},this.handlerClickMedia=function(e){i.find(" .sm-media").removeClass("active");var n=t(this).closest(".sm-media");n.addClass("active"),i.trigger("sm.change"),i.trigger("sm.change.size",[parseInt(n.attr("data-width")),parseInt(n.attr("data-height"))])},this.handlerClickScrin=function(e){t(e.target).closest(".btn-deviation, .sm-deviation").size()||(t(this).toggleClass("active"),i.trigger("sm.change"))},this.handlerChangeStaticOrFixed=function(){var e=t(this).closest(".sm-deviation");if(t(this).closest(".sm-deviation-fixed-or-static").find("input").prop("checked",!1),t(this).find(" input").prop("checked","checked"),1==t(this).find(" input").val()){var n=e.find(" .sm-deviation-relative .btn.active").first().attr("data-left");e.find(" .sm-deviation-relative .btn-group:nth-child(2) .btn").addClass("disabled"),e.find(" .sm-deviation-relative .btn-group:nth-child(3) .btn").addClass("disabled"),e.find(" .sm-deviation-relative .btn").removeClass("active btn-danger").addClass("btn-default"),e.find(' .sm-deviation-relative .btn-group:nth-child(1) .btn[data-left="'+n+'"]').removeClass("btn-default").addClass("active btn-danger"),e.find(" .sm-deviation-relative").removeClass("sm-deviation-fixed").addClass("sm-deviation-static")}else e.find(" .sm-deviation-relative .btn").removeClass("disabled"),e.find(" .sm-deviation-relative").removeClass("sm-deviation-static").addClass("sm-deviation-fixed");i.trigger("sm.change")},this.handlerChangeRelativePosition=function(){t(this).hasClass("disabled")||(t(this).closest(".sm-deviation").find(" .sm-deviation-relative .btn").removeClass("active btn-danger").addClass("btn-default"),t(this).removeClass("btn-default").addClass("active btn-danger"),i.trigger("sm.change"))},this.handlerClickBeyondLimits=function(t){n.handlerCloseDeviation(t)},this.fastShow=function(t){i.find(" .sm-container-scroll-wrap").css({display:"block"}),t.find("screenshots_manipulator").text("show"),i.trigger("sm.show")},this.show=function(t){"openSMTimeLine__close"in n&&n.openSMTimeLine__close.pause(),i.find(" .sm-container-scroll-wrap").css({display:"block",opacity:0,transform:"scale(0.8, 0.8)"}),"openSMTimeLine"in n?n.openSMTimeLine.restart():n.openSMTimeLine=(new TimelineLite).append([TweenMax.to(i.find(" .sm-container-scroll-wrap"),.5,{css:{transform:"scale(1, 1)"}}),TweenMax.to(i.find(" .sm-container-scroll-wrap"),.3,{css:{opacity:1}})]),t.find("screenshots_manipulator").text("show"),i.trigger("sm.show")},this.hide=function(t){function e(){i.find(" .sm-container-scroll-wrap").css("display","none")}n._handlerHideThumbnail(),"openSMTimeLine"in n&&n.openSMTimeLine.pause(),"openSMTimeLine__close"in n?n.openSMTimeLine__close.restart():n.openSMTimeLine__close=(new TimelineLite).append([TweenMax.to(i.find(" .sm-container-scroll-wrap"),.5,{css:{transform:"scale(0.8, 0.8)"},onComplete:e}),TweenMax.to(i.find(" .sm-container-scroll-wrap"),.5,{css:{opacity:0}})]),t.find("screenshots_manipulator").text("hidden"),i.trigger("sm.hide")},this.toggle=function(t){"show"==t.find("screenshots_manipulator").text()?n.hide(t):"hidden"==t.find("screenshots_manipulator").text()&&n.show(t)},this._handlerShowThumbnail=function(){src=shablonizator.base_url+n._options.dirThumbnail+"/"+t(this).attr("data-src"),i.find(" .sm-thumbnail img").remove(),i.find(" .sm-thumbnail-img-container").append('<img src="'+src+'" alt="" />');var e=i.find(" .sm-thumbnail");e.stop().fadeIn().css({width:n._options.widthThumbnail,top:parseInt(e.css("top"))-e.offset().top})},this._handlerHideThumbnail=function(){i.find(" .sm-thumbnail").stop().fadeOut(400,function(){i.find(" .sm-thumbnail img").remove()})},this.refresh=function(t,i,e){n.removeListScrins(),n.createListScrins(t,i,e)},this.createListScrins=function(e,s,a){var o="",d=e.find(" page[href='"+a+"']");d.find(" media").each(function(){o+='<li class="sm-media'+("true"==t(this).attr("active")?" active":"")+' clearfix" data-width="'+t(this).attr("width")+'" data-height="'+t(this).attr("height")+'">',o+='<h4 class="h-group"><span class="sm-w-h">'+t(this).attr("width")+"x"+t(this).attr("height")+"</span></h4>",t(this).find(" scrin").each(function(){var i=t(this).attr("deviation").split("|"),e=i.length-1,a=i[0],d=i[1],r="static"==a?"top":i[2],l=parseInt(i[e-3]),c=parseInt(i[e-2]),m=parseInt(i[e-1]),p=parseInt(i[e]),v=s.find(" scrin[src='"+t(this).attr("src")+"']"),h=v.attr("width"),f=v.attr("height");o+='                <div class="sm-scrin'+("true"==t(this).attr("active")?" active":"")+' panel panel-primary" data-src="'+t(this).attr("src")+'">                    <div class="panel-body">                        <strong class="sm-name-scrin">'+t(this).attr("src")+'</strong>                        <div class="floatr-fix">                            '+n.createDeviation(a,d,r,l,c,m,p)+'                            <span class="sm-w-h-scrin text-right"><kbd>'+h+"</kbd> x <kbd>"+f+"</kbd></span>                        </div>                    </div>                </div>"}),o+="</li>"}),o+='<li class="sm-all-scrins"><h4 class="h-group">Все скрины:</h4>',s.find(" scrin").each(function(){o+='            <div class="sm-scrin panel panel-default" data-src="'+t(this).attr("src")+'">                <div class="panel-body">                    <strong class="sm-name-scrin">'+t(this).attr("src")+'</strong>                    <div class="floatr-fix">                        <span class="sm-w-h-scrin"><kbd>'+t(this).attr("width")+"</kbd> x <kbd>"+t(this).attr("height")+"</kbd></span>                    </div>                </div>            </div>"}),o+="</li>",i.find(" .sm-container").append(o),n.refreshUiSortableAndSpinner()},this.createDeviation=function(t,i,e,n,s,a,o){var d="";return d+='            <div class="btn-deviation btn btn-default btn-xs"><span class="glyphicon glyphicon-move"></span></div>            <div class="sm-deviation panel panel-primary">                <div class="panel-body">                    <div class="row">                        <div class="col-xs-6 sm-deviation-col-left">                            <form class="sm-deviation-fixed-or-static btn-group-vertical btn-toggle-one-color" data-toggle="buttons">            \t\t\t\t\t<label class="btn btn-'+("static"==t?"primary active":"default")+'" data-btn-color="primary">            \t\t\t\t\t\t<input type="radio" name="sm-radio-fixed-or-static"'+("static"==t?" checked":"")+' value="1" />Static            \t\t\t\t\t</label>            \t\t\t\t\t<label class="btn btn-'+("fixed"==t?"danger active":"default")+'" data-btn-color="danger">            \t\t\t\t\t\t<input type="radio" name="sm-radio-fixed-or-static"'+("fixed"==t?" checked":"")+' value="0" />Fixed            \t\t\t\t\t</label>            \t\t\t\t</form>                        </div>                        <div class="col-xs-6 sm-deviation-col-right">                            <div class="sm-deviation-relative sm-deviation-'+t+' btn-group-table">                                <div class="btn-group btn-group-justified" role="group">                                    <div class="'+("left"==i&&"top"==e?" active btn-danger":" btn-default")+' btn" data-left="left" data-top="top" role="button">&nbsp</div>                                    <div class="'+("center"==i&&"top"==e?" active btn-danger":" btn-default")+' btn" data-left="center" data-top="top" role="button">&nbsp</div>                                    <div class="'+("right"==i&&"top"==e?" active btn-danger":" btn-default")+' btn" data-left="right" data-top="top" role="button">&nbsp</div>                                </div>                                <div class="btn-group btn-group-justified" role="group">                                    <div class="'+("left"==i&&"center"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="left" data-top="center" role="button">&nbsp</div>                                    <div class="'+("center"==i&&"center"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="center" data-top="center" role="button">&nbsp</div>                                    <div class="'+("right"==i&&"center"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="right" data-top="center" role="button">&nbsp</div>                                </div>                                <div class="btn-group btn-group-justified" role="group">                                    <div class="'+("left"==i&&"bottom"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="left" data-top="bottom" role="button">&nbsp</div>                                    <div class="'+("center"==i&&"bottom"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="center" data-top="bottom" role="button">&nbsp</div>                                    <div class="'+("right"==i&&"bottom"==e?" active btn-danger":" btn-default")+" btn"+("static"==t?" disabled":"")+'" data-left="right" data-top="bottom" role="button">&nbsp</div>                                </div>                            </div>                        </div>                    </div>                    <div class="row row-name-px-percent">                        <div class="col-xs-6 sm-deviation-col-left">                            <p>px</p>                        </div>                        <div class="col-xs-6 sm-deviation-col-right">                            <p>%</p>                        </div>                    </div>                    <div class="row row-otklonenie-1">                        <div class="col-xs-6 sm-deviation-col-left">                            <div class="input-group">                                <input type="text" class="form-control input-sm sm-deviation-input sm-deviation-left-px" value="'+n+'">                                <div class="input-group-addon"><span class="fa fa-long-arrow-right"></span></div>                            </div>                        </div>                        <div class="col-xs-6 sm-deviation-col-right">                            <div class="input-group">                                <input type="text" class="form-control input-sm sm-deviation-input sm-deviation-left-percent" value="'+s+'">                                <div class="input-group-addon"><span class="fa fa-long-arrow-right"></span></div>                            </div>                        </div>                    </div>                    <div class="row row-otklonenie-2">                        <div class="col-xs-6 sm-deviation-col-left">                            <div class="input-group">                                <input type="text" class="form-control input-sm sm-deviation-input sm-deviation-top-px" value="'+a+'">                                <div class="input-group-addon">&nbsp<span class="fa fa-long-arrow-down"></span>&nbsp</div>                            </div>                        </div>                        <div class="col-xs-6 sm-deviation-col-right">                            <div class="input-group">                                <input type="text" class="form-control input-sm sm-deviation-input sm-deviation-top-percent" value="'+o+'">                                <div class="input-group-addon">&nbsp<span class="fa fa-long-arrow-down"></span>&nbsp</div>                            </div>                        </div>                    </div>                </div>            </div>'},this.removeListScrins=function(){i.find(" .sm-container").empty()},this.refreshUiSortableAndSpinner=function(){i.find(" .sm-container").sortable({revert:!0,update:function(t,i){},cursor:"move",axis:"y",items:" > .sm-media",distance:5,placeholder:{element:function(i){return t('<div class="sm-placeholder-media"></div>').height(i.outerHeight())},update:function(t,i){}},stop:function(){i.trigger("sm.change")}}),i.find(" .sm-container .sm-media").sortable({revert:!0,cursor:"move",axis:"y",items:" > .sm-scrin",distance:5,connectWith:" .sm-container .sm-media, .sm-container .sm-all-scrins",placeholder:{element:function(i){return t('<div class="panel panel-default sm-placeholder-scrin"></div>').height(i.outerHeight())},update:function(t,i){}},remove:function(t,i){i.item.closest(".sm-all-scrins").size()&&i.item.remove()},stop:function(){i.trigger("sm.change")}}),i.find(" .sm-container .sm-all-scrins").sortable({revert:!0,cursor:"move",axis:"y",items:" > .sm-scrin",distance:5,connectWith:" .sm-container .sm-media",placeholder:{element:function(i){return t('<div class="panel panel-default sm-placeholder-scrin"></div>').height(i.outerHeight())},update:function(t,i){}},remove:function(i,e){var s=e.item.clone();s.insertAfter(e.item),s.find(" .floatr-fix").prepend(n.createDeviation("static","center","top",0,0,0,0)),n.refreshSpinner(),t(this).sortable("cancel")},stop:function(){i.trigger("sm.change")}}),n.refreshSpinner()},this.refreshSpinner=function(){var e=!1;i.find(" .sm-deviation-input").spinner({min:-99999,max:99999,start:function(){e=t(this).closest(".sm-media").hasClass("active"),e&&i.trigger("sm.changeoffsetstart",[t(this)])},spin:function(){e&&i.trigger("sm.changeoffset")},stop:function(){i.trigger("sm.change")}})},this._restoreSession=function(t){"show"==t.find("screenshots_manipulator").text()?n.fastShow(t):"hidden"==t.find("screenshots_manipulator").text()&&n.hide(t)},this._setSession=function(e,n,s){var a=e.find(" page[href='"+s+"']");0==a.size()?(e.find(" wrap").append('<page href="'+s+'"></page>'),a=e.find(" page[href='"+s+"']")):a.empty();var o="";i.find(" .sm-container .sm-media").each(function(){o+='<media width="'+t(this).attr("data-width")+'" height="'+t(this).attr("data-height")+'" active="'+t(this).hasClass("active")+'">',t(this).find(" .sm-scrin").each(function(){var i=1==t(this).find(" .sm-deviation-fixed-or-static input:checked").val()?"static":"fixed",e=t(this).find(" .sm-deviation-relative .btn.active"),n=e.attr("data-left"),s=e.attr("data-top"),a=t(this).find(" .sm-deviation-left-px").val(),d=t(this).find(" .sm-deviation-left-percent").val(),r=t(this).find(" .sm-deviation-top-px").val(),l=t(this).find(" .sm-deviation-top-percent").val();o+='<scrin src="'+t(this).attr("data-src")+'" active="'+t(this).hasClass("active")+'" deviation="'+i+"|"+n+"|"+s+"|"+a+"|"+d+"|"+r+"|"+l+'"></scrin>'}),o+="</media>"}),a.append(t(o))}};modules.screenshotsManipulator=i}(jQuery);
//# sourceMappingURL=screenshots-manipulator.js.map
