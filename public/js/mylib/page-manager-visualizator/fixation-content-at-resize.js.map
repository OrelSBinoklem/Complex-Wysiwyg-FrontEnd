{"version":3,"sources":["js/mylib/page-manager-visualizator/fixation-content-at-resize.js"],"names":["$","fixationContentAtResize","$container","options","this","_options","____","_create","activeFixation","$itemFixation","undefined","itemFixationY","window","nameIFrame","on","_handlerResize","_destroy","off","reload","startFixation","xEl","yEl","scrollTop","scrollLeft","wWin","hWin","winY","winX","$iFrameBody","contents","find","width","height","gorizontalFixation","verticalFixation","AllEl","Array","AllDistance","AllYEl","each","offset","tEl","Math","round","top","lEl","left","wEl","outerWidth","hEl","outerHeight","push","sqrt","pow","length","min","minKey","key","stopFixation","modules","jQuery"],"mappings":"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","file":"fixation-content-at-resize.js","sourcesContent":["//==============================================\r\n//\"ИНТЕЛЛЕКТУАЛЬНЫЙ РЕСАЙЗ IFRAME\"\r\n//При тестировании вёрстки\r\n//при разных разрешениях часто бывает так\r\n//что при изменении ширины экрана\r\n//нужный вам блок за которым вы наблюдаете\r\n//уходит вверх либо вниз, так вот этот метод \r\n//фиксирует на ближайшем к центру или\r\n//к верху и центру по горизонтали\r\n//экрана элементу с помощью компенсации скролла\r\n//(уедет вниз на 10px то и скрол прокрутиться\r\n//на 10px вниз...)\r\n//==============================================\r\n(function($){//Модули: \r\n\r\nvar defaultOptions = {\r\n    active: true,\r\n    gorizontalFixation: \"center\",//left center right\r\n    verticalFixation: \"top\"//top center bottom\r\n};\r\n\r\nvar fixationContentAtResize = function($container, options) {\r\n    this._options = options;\r\n    var ____ = this;\r\n    \r\n    this._create = function() {\r\n        //Свойства для фиксатора\r\n        ____.activeFixation = false;\r\n        ____.$itemFixation = undefined;\r\n        ____.itemFixationY = undefined;\r\n        \r\n        //Установка обработчиков событий\r\n        $(window[____._options.nameIFrame].window).on('resize', ____._handlerResize);\r\n    }\r\n    \r\n    this._destroy = function() {\r\n        $(window[____._options.nameIFrame].window).off('resize', ____._handlerResize);\r\n    }\r\n    \r\n    this.reload = function() {\r\n        ____._destroy();\r\n        ____._create();\r\n    }\r\n    \r\n    this.startFixation = function() {\r\n        ____.activeFixation = true;\r\n        ____.$itemFixation = undefined;\r\n        \r\n        var $iFrameBody = $(\"#\"+(____._options.nameIFrame)).contents().find('body');\r\n        var xEl, yEl,\r\n        scrollTop, scrollLeft, wWin, hWin, winY, winX;\r\n        \r\n        //Ищем ближайший по заданым параметрам элемент в видимой части документа (если ненаходим элементов в видимой части экрана то ничё неделаем)\r\n        wWin = $(window[____._options.nameIFrame].window).width();\r\n        hWin = $(window[____._options.nameIFrame].window).height();\r\n        \r\n        scrollTop = $(window[____._options.nameIFrame].window).scrollTop();\r\n        scrollLeft = $(window[____._options.nameIFrame].window).scrollLeft();\r\n        \r\n        switch( ____._options.gorizontalFixation ) {\r\n            case \"left\":\r\n              winX = 0; \r\n              break;\r\n            case \"center\": \r\n              winX = wWin / 2;\r\n              break;\r\n            case \"right\":\r\n              winX = wWin;\r\n              break;\r\n        }\r\n        \r\n        switch( ____._options.verticalFixation ) {\r\n            case \"top\":\r\n              winY = 0; \r\n              break;\r\n            case \"center\": \r\n              winY = hWin / 2;\r\n              break;\r\n            case \"bottom\":\r\n              winY = hWin;\r\n              break;\r\n        }\r\n        \r\n        var AllEl = new Array();\r\n        var AllDistance = new Array();\r\n        var AllYEl = new Array();\r\n        \r\n        $iFrameBody.find(' *:visible').each(function(){\r\n            var offset = $(this).offset();\r\n            var tEl = Math.round( offset.top );\r\n            var lEl = Math.round( offset.left );\r\n            var wEl = Math.round( $(this).outerWidth() );\r\n            var hEl = Math.round( $(this).outerHeight() );\r\n            \r\n            \r\n            switch( ____._options.gorizontalFixation ) {\r\n                case \"left\":\r\n                  xEl = lEl - scrollLeft; \r\n                  break;\r\n                case \"center\": \r\n                  xEl = lEl - scrollLeft + (wEl / 2);\r\n                  break;\r\n                case \"right\":\r\n                  xEl = lEl - scrollLeft + wEl;\r\n                  break;\r\n            }\r\n            xEl = Math.round( xEl );\r\n            \r\n            switch( ____._options.verticalFixation ) {\r\n                case \"top\":\r\n                  yEl = tEl - scrollTop; \r\n                  break;\r\n                case \"center\":\r\n                  yEl = tEl - scrollTop + (hEl / 2);\r\n                  break;\r\n                case \"bottom\":\r\n                  yEl = tEl - scrollTop + hEl;\r\n                  break;\r\n            }\r\n            yEl = Math.round( yEl );\r\n            \r\n            if( xEl + wEl >= 0 && xEl <= wWin && yEl + hEl >= 0 && yEl <= hWin ) {\r\n                AllEl.push( $(this) );\r\n                AllDistance.push( Math.sqrt(Math.pow(winX - xEl, 2) + Math.pow(winY - yEl, 2)) );\r\n                AllYEl.push( yEl );\r\n            }\r\n        });\r\n        \r\n        if(AllEl.length) {\r\n            var min, minKey;\r\n            min = AllDistance[0];\r\n            minKey = 0;\r\n            \r\n            for(var key in AllEl) {\r\n                if(AllDistance[key] < min) {\r\n                    min = AllDistance[key];\r\n                    minKey = key;\r\n                }\r\n            }\r\n            \r\n            ____.$itemFixation = AllEl[minKey];\r\n            ____.itemFixationY = AllYEl[minKey];\r\n            \r\n            /*$iFrameBody.find(' *').css({\r\n                outline: \"0 solid red\",\r\n                outlineOffset: \"-2px\"\r\n            });\r\n            ____.$itemFixation.css({\r\n                outline: \"5px solid red\",\r\n                outlineOffset: \"-2px\"\r\n            });*/\r\n        }\r\n    }\r\n    \r\n    this.stopFixation = function() {\r\n        ____.activeFixation = false;\r\n    }\r\n    \r\n    this._handlerResize = function() {\r\n        if( ____.activeFixation && (____.$itemFixation !== undefined) ) {\r\n            var scrollTop = $(window[____._options.nameIFrame].window).scrollTop();\r\n             \r\n            var offset = ____.$itemFixation.offset();\r\n            var tEl = offset.top;\r\n            var hEl = ____.$itemFixation.outerHeight();\r\n            \r\n            switch( ____._options.verticalFixation ){\r\n                case \"top\":\r\n                  yEl = tEl - scrollTop; \r\n                  break;\r\n                case \"center\": \r\n                  yEl = tEl - scrollTop + (hEl / 2);\r\n                  break;\r\n                case \"bottom\":\r\n                  yEl = tEl - scrollTop + hEl;\r\n                  break;\r\n            }\r\n            yEl = Math.round( yEl );\r\n\r\n            $(window[____._options.nameIFrame].window).scrollTop( Math.round( scrollTop ) + yEl - ____.itemFixationY );\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nmodules.fixationContentAtResize = fixationContentAtResize;\r\n    \r\n})(jQuery);"]}