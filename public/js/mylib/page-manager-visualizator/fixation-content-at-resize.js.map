{"version":3,"sources":["js/mylib/page-manager-visualizator/fixation-content-at-resize.js"],"names":["$","fixationContentAtResize","$container","options","this","_options","____","_create","activeFixation","$itemFixation","undefined","itemFixationY","window","nameIFrame","on","_handlerResize","_destroy","off","reload","startFixation","xEl","yEl","scrollTop","scrollLeft","wWin","hWin","winY","winX","$iFrameBody","contents","find","width","height","gorizontalFixation","verticalFixation","AllEl","Array","AllDistance","AllYEl","each","css","toLowerCase","attr","not","offset","tEl","Math","round","top","lEl","left","wEl","outerWidth","hEl","outerHeight","push","sqrt","pow","length","min","minKey","key","stopAllAnimationsAtResize","$iFrameHead","append","html","stopFixation","removeAttr","remove","trigger","modules","jQuery"],"mappings":"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","file":"fixation-content-at-resize.js","sourcesContent":["//==============================================\r\n//\"ИНТЕЛЛЕКТУАЛЬНЫЙ РЕСАЙЗ IFRAME\"\r\n//При тестировании вёрстки\r\n//при разных разрешениях часто бывает так\r\n//что при изменении ширины экрана\r\n//нужный вам блок за которым вы наблюдаете\r\n//уходит вверх либо вниз, так вот этот метод \r\n//фиксирует на ближайшем к центру или\r\n//к верху и центру по горизонтали\r\n//экрана элементу с помощью компенсации скролла\r\n//(уедет вниз на 10px то и скрол прокрутиться\r\n//на 10px вниз...)\r\n//==============================================\r\n(function($){//Модули: \r\n\r\nvar defaultOptions = {\r\n    //active: true,\r\n    gorizontalFixation: \"center\",//left center right\r\n    verticalFixation: \"top\",//top center bottom\r\n    stopAllAnimationsAtResize: true\r\n};\r\n\r\nvar fixationContentAtResize = function($container, options) {\r\n    this._options = options;\r\n    var ____ = this;\r\n    \r\n    this._create = function() {\r\n        //Свойства для фиксатора\r\n        ____.activeFixation = false;\r\n        ____.$itemFixation = undefined;\r\n        ____.itemFixationY = undefined;\r\n        \r\n        //Установка обработчиков событий\r\n        $(window[____._options.nameIFrame].window).on('resize', ____._handlerResize);\r\n    }\r\n    \r\n    this._destroy = function() {\r\n        $(window[____._options.nameIFrame].window).off('resize', ____._handlerResize);\r\n    }\r\n    \r\n    this.reload = function() {\r\n        ____._destroy();\r\n        ____._create();\r\n    }\r\n    \r\n    this.startFixation = function() {\r\n        if(window[____._options.nameIFrame] !== undefined) {\r\n            ____.activeFixation = true;\r\n            ____.$itemFixation = undefined;\r\n\r\n            var $iFrameBody = $(\"#\"+(____._options.nameIFrame)).contents().find('body');\r\n            var xEl, yEl,\r\n                scrollTop, scrollLeft, wWin, hWin, winY, winX;\r\n\r\n            //Ищем ближайший по заданым параметрам элемент в видимой части документа (если ненаходим элементов в видимой части экрана то ничё неделаем)\r\n            wWin = $(window[____._options.nameIFrame].window).width();\r\n            hWin = $(window[____._options.nameIFrame].window).height();\r\n\r\n            scrollTop = $(window[____._options.nameIFrame].window).scrollTop();\r\n            scrollLeft = $(window[____._options.nameIFrame].window).scrollLeft();\r\n\r\n            switch( ____._options.gorizontalFixation ) {\r\n                case \"left\": winX = 0; break;\r\n                case \"center\": winX = wWin / 2; break;\r\n                case \"right\": winX = wWin; break;\r\n            }\r\n\r\n            switch( ____._options.verticalFixation ) {\r\n                case \"top\": winY = 0; break;\r\n                case \"center\": winY = hWin / 2; break;\r\n                case \"bottom\": winY = hWin; break;\r\n            }\r\n\r\n            var AllEl = new Array();\r\n            var AllDistance = new Array();\r\n            var AllYEl = new Array();\r\n\r\n            //Элементы должны быть нетолько видимыми но и неиметь position fixed а так же не один из их родителей\r\n            $iFrameBody.find(' *:visible').each(function(){\r\n                if($(this).css(\"position\").toLowerCase() == \"fixed\") {\r\n                    $(this).attr(\"data-this-el-position-fixed\", \"this-el-position-fixed\");\r\n                }\r\n            });\r\n            $iFrameBody.find(' *:visible')\r\n                .not($iFrameBody.find(' [data-this-el-position-fixed=\"this-el-position-fixed\"] *'))\r\n                .not($iFrameBody.find(' [data-this-el-position-fixed=\"this-el-position-fixed\"]'))\r\n                .each(function(){\r\n\r\n                    var offset = $(this).offset();\r\n                    var tEl = Math.round( offset.top );\r\n                    var lEl = Math.round( offset.left );\r\n                    var wEl = Math.round( $(this).outerWidth() );\r\n                    var hEl = Math.round( $(this).outerHeight() );\r\n\r\n\r\n                    switch( ____._options.gorizontalFixation ) {\r\n                        case \"left\": xEl = lEl - scrollLeft; break;\r\n                        case \"center\": xEl = lEl - scrollLeft + (wEl / 2); break;\r\n                        case \"right\": xEl = lEl - scrollLeft + wEl; break;\r\n                    }\r\n                    xEl = Math.round( xEl );\r\n\r\n                    switch( ____._options.verticalFixation ) {\r\n                        case \"top\": yEl = tEl - scrollTop; break;\r\n                        case \"center\": yEl = tEl - scrollTop + (hEl / 2); break;\r\n                        case \"bottom\": yEl = tEl - scrollTop + hEl; break;\r\n                    }\r\n                    yEl = Math.round( yEl );\r\n\r\n                    if( xEl + wEl >= 0 && xEl <= wWin && yEl + hEl >= 0 && yEl <= hWin ) {\r\n                        AllEl.push( $(this) );\r\n                        AllDistance.push( Math.sqrt(Math.pow(winX - xEl, 2) + Math.pow(winY - yEl, 2)) );\r\n                        AllYEl.push( yEl );\r\n                    }\r\n                });\r\n\r\n            if(AllEl.length) {\r\n                var min, minKey;\r\n                min = AllDistance[0];\r\n                minKey = 0;\r\n\r\n                for(var key in AllEl) {\r\n                    if(AllDistance[key] < min) {\r\n                        min = AllDistance[key];\r\n                        minKey = key;\r\n                    }\r\n                }\r\n\r\n                ____.$itemFixation = AllEl[minKey];\r\n                ____.itemFixationY = AllYEl[minKey];\r\n\r\n                /*____.$itemFixation.css({\r\n                     outline: \"5px solid red\",\r\n                     outlineOffset: \"-2px\"\r\n                 });*/\r\n\r\n                if(____._options.stopAllAnimationsAtResize) {\r\n                    var $iFrameHead = $(\"#\"+(____._options.nameIFrame)).contents().find('head');\r\n\r\n                    $iFrameHead.append('<style type=\"text/css\" class=\"fixation-content-at-resize-stop-all-animations\"></style>');\r\n                    $iFrameHead.find(\" .fixation-content-at-resize-stop-all-animations\").html('body, body *{transition-duration: 0s !important;}');\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    this.stopFixation = function() {\r\n        ____.activeFixation = false;\r\n\r\n        var $iFrameBody = $(\"#\"+(____._options.nameIFrame)).contents().find('body');\r\n        $iFrameBody.find(' *').removeAttr(\"data-this-el-position-fixed\");\r\n\r\n        if(____._options.stopAllAnimationsAtResize) {\r\n            var $iFrameHead = $(\"#\"+(____._options.nameIFrame)).contents().find('head');\r\n            $iFrameHead.find(\" .fixation-content-at-resize-stop-all-animations\").remove();\r\n        }\r\n    }\r\n    \r\n    this._handlerResize = function() {\r\n        if( ____.activeFixation && (____.$itemFixation !== undefined) ) {\r\n            var scrollTop = $(window[____._options.nameIFrame].window).scrollTop();\r\n             \r\n            var offset = ____.$itemFixation.offset();\r\n            var tEl = offset.top;\r\n            var hEl = ____.$itemFixation.outerHeight();\r\n\r\n            var yEl = null;\r\n            \r\n            switch( ____._options.verticalFixation ) {\r\n                case \"top\":\r\n                  yEl = tEl - scrollTop; \r\n                  break;\r\n                case \"center\": \r\n                  yEl = tEl - scrollTop + (hEl / 2);\r\n                  break;\r\n                case \"bottom\":\r\n                  yEl = tEl - scrollTop + hEl;\r\n                  break;\r\n            }\r\n\r\n            $(window[____._options.nameIFrame].window).scrollTop( Math.round( scrollTop + yEl - ____.itemFixationY ) );\r\n\r\n            $container.trigger(\"fcar.scroll\");\r\n        }\r\n    }\r\n}\r\n\r\nmodules.fixationContentAtResize = fixationContentAtResize;\r\n    \r\n})(jQuery);"]}