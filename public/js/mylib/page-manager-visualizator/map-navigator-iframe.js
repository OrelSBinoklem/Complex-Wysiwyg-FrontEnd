!function(e){var o=function(o,n){this._options=n;var r=this;r._last_cursor_Y=0,r._last_cursor_X=0,this._create=function(){var o=e("#"+r._options.nameIFrame).contents();r._options.$mapNavigatorContainer.append('<div class="mnif-show-space panel panel-primary"><div class="mnif-draggable panel-body"></div></div>'),r._draggable=!1,r._cursor_Y=0,r._cursor_X=0,r._draggableTopTemp=0,r._draggableLeftTemp=0,o.find("body").on("mousemove",r._handlerMove),e("body").on("mousemove",r._handlerMove),e("body").on("keydown",r._handlerKeyDown),o.find("body").on("keydown",r._handlerKeyDown),r._options.$mapNavigatorContainer.find(" .mnif-draggable").on("mousedown",r._handlerMouseDown),e("body").on("keyup mouseup",r._handlerUp),o.find("body").on("keyup mouseup",r._handlerUp),r.updateDraggable()},this._destroy=function(){r._options.$mapNavigatorContainer.find(" .mnif-show-space").remove();var o=e("#"+r._options.nameIFrame).contents();o.find("body").off("mousemove",r._handlerMove),e("body").off("mousemove",r._handlerMove),e("body").off("keydown",r._handlerKeyDown),o.find("body").off("keydown",r._handlerKeyDown),r._options.$mapNavigatorContainer.find(" .mnif-draggable").off("mousedown",r._handlerMouseDown),e("body").off("keyup mouseup",r._handlerUp),o.find("body").off("keyup mouseup",r._handlerUp)},this.reload=function(){r._destroy(),r._create()},this._handlerKeyDown=function(e){69!=e.which||!e.ctrlKey||e.shiftKey||e.altKey||r._handlerDown(e)},this._handlerMouseDown=function(e){r._handlerDown(e)},this._handlerDown=function(e){if(!r._draggable){var n=r._options.$mapNavigatorContainer.find(" .mnif-show-space");n.attr("style","");n.outerWidth(),n.outerHeight(),o.find(" .pmv-outer-wrap").width(),o.find(" .pmv-outer-wrap").height();r._draggable=!0,r._cursor_X=!1,r._cursor_Y=!1,r._draggableTopTemp=o.find(" .pmv-fitting-wrap").position().top,r._draggableLeftTemp=o.find(" .pmv-fitting-wrap").position().left,r.updateDraggable()}return e.preventDefault?e.preventDefault():e.stop(),e.returnValue=!1,e.stopPropagation(),!1},this._handlerUp=function(e){r._draggable&&(r._draggable=!1)},this.updateDraggable=function(){var o,n,t,a,s,i,p,d,_,f,m,h,u=e("#"+r._options.nameIFrame),l=u.closest(".pmv-fitting-wrap"),g=u.closest(".pmv-outer-wrap"),c=r._options.$mapNavigatorContainer.find(" .mnif-show-space");o=l.width(),n=l.height(),a=l.position().top,s=l.position().left,t=g.width(),i=g.height(),m=c.width(),h=c.height(),d=i/n*h,d<r._options.minHDraggable&&(d=r._options.minHDraggable),d>h&&(d=h),_=a/-(n-i)*(h-d),p=t/o*m,p<r._options.minWDraggable&&(p=r._options.minWDraggable),p>m&&(p=m),f=s/-(o-t)*(m-p),c.find(".mnif-draggable").css({width:Math.round(p),height:Math.round(d),top:Math.round(_),left:Math.round(f)}),s>=0?c.css({borderLeftStyle:"solid"}):c.css({borderLeftStyle:"dashed"}),s+o<=t?c.css({borderRightStyle:"solid"}):c.css({borderRightStyle:"dashed"}),a>=0?c.css({borderTopStyle:"solid"}):c.css({borderTopStyle:"dashed"}),a+n<=i?c.css({borderBottomStyle:"solid"}):c.css({borderBottomStyle:"dashed"})},this._handlerMove=function(o){if(r._last_cursor_X=o.screenX,r._last_cursor_Y=o.screenY,r._draggable){r._cursor_Y===!1&&(r._cursor_X=r._last_cursor_X,r._cursor_Y=r._last_cursor_Y);var n,t,a,s,i,p,d,_,f,m,h,u,l,g,c,v,b=e("#"+r._options.nameIFrame),y=b.closest(".pmv-fitting-wrap"),T=b.closest(".pmv-outer-wrap"),w=r._options.$mapNavigatorContainer.find(" .mnif-show-space");n=y.width(),t=y.height(),i=y.position().top,p=y.position().left,a=T.width(),s=T.height(),h=w.width(),u=w.height(),_=s/t*u,_<r._options.minHDraggable&&(_=r._options.minHDraggable),d=a/n*h,d<r._options.minWDraggable&&(d=r._options.minWDraggable),t>s&&(l=(s-t)/(u-_),c=(o.screenY-r._cursor_Y)*l+r._draggableTopTemp,f=c/-(t-s)*(u-_),c>0&&(c=0,r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_Y=o.screenY,r._draggableTopTemp=i),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&f<-r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_Y+=f+r._options.movementOfTheCursorInAConfinedSpaceSpred)),c<-(t-s)&&(c=-(t-s),r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_Y=o.screenY,r._draggableTopTemp=i),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&f>u-_+r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_Y+=f-(u-_+r._options.movementOfTheCursorInAConfinedSpaceSpred))),y.css({top:Math.round(c)})),n>a&&(g=(a-n)/(h-d),v=(o.screenX-r._cursor_X)*g+r._draggableLeftTemp,m=v/-(n-a)*(h-d),v>0&&(v=0,r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_X=o.screenX,r._draggableLeftTemp=p),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&m<-r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_X+=m+r._options.movementOfTheCursorInAConfinedSpaceSpred)),v<-(n-a)&&(v=-(n-a),r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_X=o.screenX,r._draggableLeftTemp=p),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&m>h-d+r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_X+=m-(h-d+r._options.movementOfTheCursorInAConfinedSpaceSpred))),y.css({left:Math.round(v)})),r.updateDraggable()}}};modules.mapNavigatorIFrame=o}(jQuery);
//# sourceMappingURL=map-navigator-iframe.js.map
