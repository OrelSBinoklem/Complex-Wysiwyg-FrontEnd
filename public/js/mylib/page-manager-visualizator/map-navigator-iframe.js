!function(e){var o=function(o,n){this._options=n;var r=this;r._last_cursor_Y=0,r._last_cursor_X=0,this._create=function(){var o=e("#"+r._options.nameIFrame).contents();r._options.$mapNavigatorContainer.append('<div class="mnif-show-space panel panel-primary"><div class="mnif-draggable panel-body"></div></div>'),r._draggable=!1,r._cursor_Y=0,r._cursor_X=0,r._draggableTopTemp=0,r._draggableLeftTemp=0,o.find("body").on("mousemove",r._handlerMove),e("body").on("mousemove",r._handlerMove),e("body").on("keydown",r._handlerKeyDown),o.find("body").on("keydown",r._handlerKeyDown),r._options.$mapNavigatorContainer.find(" .mnif-draggable").on("mousedown",r._handlerMouseDown),e("body").on("keyup mouseup",r._handlerUp),o.find("body").on("keyup mouseup",r._handlerUp),r.updateDraggable()},this._destroy=function(){r._options.$mapNavigatorContainer.find(" .mnif-show-space").remove();var o=e("#"+r._options.nameIFrame).contents();o.find("body").off("mousemove",r._handlerMove),e("body").off("mousemove",r._handlerMove),e("body").off("keydown",r._handlerKeyDown),o.find("body").off("keydown",r._handlerKeyDown),r._options.$mapNavigatorContainer.find(" .mnif-draggable").off("mousedown",r._handlerMouseDown),e("body").off("keyup mouseup",r._handlerUp),o.find("body").off("keyup mouseup",r._handlerUp)},this.reload=function(){r._destroy(),r._create()},this._handlerKeyDown=function(e){69!=e.which||!e.ctrlKey||e.shiftKey||e.altKey||r._handlerDown(e)},this._handlerMouseDown=function(e){r._handlerDown(e)},this._handlerDown=function(e){if(!r._draggable){var n=r._options.$mapNavigatorContainer.find(" .mnif-show-space");n.attr("style","");n.outerWidth(),n.outerHeight(),o.find(" .pmv-outer-wrap").width(),o.find(" .pmv-outer-wrap").height();r._draggable=!0,r._cursor_X=!1,r._cursor_Y=!1,r._draggableTopTemp=o.find(" .pmv-fitting-wrap").position().top,r._draggableLeftTemp=o.find(" .pmv-fitting-wrap").position().left,r.updateDraggable()}return e.preventDefault?e.preventDefault():e.stop(),e.returnValue=!1,e.stopPropagation(),!1},this._handlerUp=function(e){r._draggable&&(r._draggable=!1)},this.updateDraggable=function(){var o,n,t,a,s,i,p,d,_,f,m,h,g=e("#"+r._options.nameIFrame),u=g.closest(".pmv-fitting-wrap"),l=g.closest(".pmv-outer-wrap"),c=r._options.$mapNavigatorContainer.find(" .mnif-show-space");o=u.width(),n=u.height(),a=u.position().top,s=u.position().left,t=l.width(),i=l.height(),m=c.width(),h=c.height(),d=i/n*h,d<r._options.minHDraggable&&(d=r._options.minHDraggable),d>h&&(d=h),_=a/-(n-i)*(h-d),p=t/o*m,p<r._options.minWDraggable&&(p=r._options.minWDraggable),p>m&&(p=m),f=s/-(o-t)*(m-p),c.find(".mnif-draggable").css({width:Math.round(p),height:Math.round(d),top:Math.round(_),left:Math.round(f)}),s>=0?c.css({borderLeftStyle:"solid"}):c.css({borderLeftStyle:"dashed"}),s+o<=t?c.css({borderRightStyle:"solid"}):c.css({borderRightStyle:"dashed"}),a>=0?c.css({borderTopStyle:"solid"}):c.css({borderTopStyle:"dashed"}),a+n<=i?c.css({borderBottomStyle:"solid"}):c.css({borderBottomStyle:"dashed"})},this._handlerMove=function(n){if(r._last_cursor_X=n.screenX,r._last_cursor_Y=n.screenY,r._draggable){r._cursor_Y===!1&&(r._cursor_X=r._last_cursor_X,r._cursor_Y=r._last_cursor_Y);var t,a,s,i,p,d,_,f,m,h,g,u,l,c,v,b,y=e("#"+r._options.nameIFrame),T=y.closest(".pmv-fitting-wrap"),w=y.closest(".pmv-outer-wrap"),C=r._options.$mapNavigatorContainer.find(" .mnif-show-space");t=T.width(),a=T.height(),p=T.position().top,d=T.position().left,s=w.width(),i=w.height(),g=C.width(),u=C.height(),f=i/a*u,f<r._options.minHDraggable&&(f=r._options.minHDraggable),_=s/t*g,_<r._options.minWDraggable&&(_=r._options.minWDraggable),a>i&&(l=(i-a)/(u-f),v=(n.screenY-r._cursor_Y)*l+r._draggableTopTemp,m=v/-(a-i)*(u-f),v>0&&(v=0,r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_Y=n.screenY,r._draggableTopTemp=p),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&m<-r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_Y+=m+r._options.movementOfTheCursorInAConfinedSpaceSpred)),v<-(a-i)&&(v=-(a-i),r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_Y=n.screenY,r._draggableTopTemp=p),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&m>u-f+r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_Y+=m-(u-f+r._options.movementOfTheCursorInAConfinedSpaceSpred))),T.css({top:Math.round(v)}),o.trigger("mnif.changePos")),t>s&&(c=(s-t)/(g-_),b=(n.screenX-r._cursor_X)*c+r._draggableLeftTemp,h=b/-(t-s)*(g-_),b>0&&(b=0,r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_X=n.screenX,r._draggableLeftTemp=d),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&h<-r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_X+=h+r._options.movementOfTheCursorInAConfinedSpaceSpred)),b<-(t-s)&&(b=-(t-s),r._options.responsiveToMovementOfTheCursorInAConfinedSpace||(r._cursor_X=n.screenX,r._draggableLeftTemp=d),r._options.responsiveToMovementOfTheCursorInAConfinedSpace&&h>g-_+r._options.movementOfTheCursorInAConfinedSpaceSpred&&(r._cursor_X+=h-(g-_+r._options.movementOfTheCursorInAConfinedSpaceSpred))),T.css({left:Math.round(b)}),o.trigger("mnif.changePos")),r.updateDraggable()}}};modules.mapNavigatorIFrame=o}(jQuery);
//# sourceMappingURL=map-navigator-iframe.js.map
